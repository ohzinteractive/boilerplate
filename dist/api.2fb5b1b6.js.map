{"version":3,"sources":["BaseApplication.js","CameraManager.js","Screen.js","Configuration.js","Time.js","KeyboardInput.js","Input.js","primitives/Sphere.js","editor/shaders/object_picker_vert.glsl","editor/shaders/object_picker_frag.glsl","Mesh.js","primitives/Arrow.js","SceneManager.js","utilities/MathUtilities.js","utilities/CameraUtilities.js","Capabilities.js","utilities/EasingFunctions.js","EventManager.js","components/AxisHelper.js","shaders/basic_color/basic_color_vert.glsl","shaders/basic_color/basic_color_frag.glsl","render_mode/BaseRender.js","RenderLayers.js","shaders/box_blur/compose_frag.glsl","shaders/box_blur/box_blur_frag.glsl","shaders/copy/copy_frag.glsl","shaders/copy/copy_vert.glsl","render_mode/OutlineRender.js","UI.js","materials/BlitMaterial.js","shaders/clear/clear_depth_normal_frag.glsl","materials/ClearDepthNormalMaterial.js","shaders/depth_normals/depth_normals_vert.glsl","shaders/depth_normals/depth_normals_frag.glsl","materials/DepthNormalMaterial.js","render_utilities/DepthAndNormalsRenderer.js","render_utilities/Blitter.js","Graphics.js","primitives/Cube.js","Debug.js","render_mode/NormalRender.js","utilities/ObjectUtilities.js","PerspectiveCamera.js","static_batcher/GeometryBatch.js","static_batcher/GeometryBatcher.js","RenderLoop.js","resource_loader/AbstractLoader.js","resource_loader/TextureLoader.js","resource_loader/GLTFLoader.js","resource_loader/DAELoader.js","resource_loader/TextLoader.js","resource_loader/CubemapLoader.js","resource_loader/AudioLoader.js","resource_loader/JSONLoader.js","ResourceContainer.js","resource_loader/ResourceBatch.js","utilities/TimeUtilities.js","utilities/Validation.js","shaders/grid/grid_frag.glsl","shaders/grid/grid_vert.glsl","utilities/GeometryUtilities.js","components/Grid.js","Components.js","index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js","js/components/CameraController/states/CameraViewState.js","js/components/CameraController/states/CameraDebugState.js","js/components/CameraController/movement_mode/CameraMovementMode.js","js/components/CameraController/movement_mode/ImmediateMode.js","js/components/CameraController/CameraController.js","MainApplication.js","api.js"],"names":["BaseApplication","CameraManager","_current","undefined","camera","camera_manager","module","exports","Screen","width","height","width_height","THREE","Vector2","screen_materials","native_width","native_height","pixel_size","x","y","i","length","uniforms","_ScreenSize","value","vector2","multiplyScalar","window","devicePixelRatio","innerWidth","innerHeight","mat","push","index","indexOf","splice","Configuration","parameters","dpr","is_mobile","is_ios","is_ipad","vertex_image_unit_supported","min_zoom_distance","max_zoom_distance","max_zoom_distance_scale","zoom_speed","use_fxaa","use_ssaa","background_color","Color","touch_sensitivity","zoom_sensitivity","spin_sensitivity","three_finger_rotation_speed","three_finger_allowed_x_rotation_offset","three_finger_allowed_y_rotation_offset","use_touch_gestures","texture_float_supported","use_ortographic","hover_enabled","rotation_enabled","transparency_amount","show_debug_sphere_on_floor_selection","show_debug_sphere_on_steps_in_floor","display_cleanup_log","navigation_speed_damping","navigation_speed","out_of_bounds_force","mouse_zoom_speed","touch_zoom_speed","json","configuration","Time","___time","Clock","__delta_time","__elapsed_time","__allocated_time","getDelta","getElapsedTime","delta_time","elapsed_time","time","KeyboardInput","ctrlz_pressed","ctrlz_fired","keys","document","onkeydown","on_key_down","bind","onkeyup","on_key_up","onkeypress","on_key_press","e","keyCode","ctrlKey","key","press_key","release_keys","pressed","fired","down","key_name","up","keyboard_input","Input","mouse_pos","last_mouse_pos","mouse_dir","__clicked_time","is_mouse_down","is_mouse_up","rotation_angle","_normalized_mouse_pos","left_mouse_button_down","left_mouse_button_pressed","left_mouse_button_released","middle_mouse_button_down","right_mouse_button_down","right_mouse_button_pressed","right_mouse_button_released","mousewheel","previous_scale","previous_rotation","previous_rotation_dirty","mouse_str","tmp_mouse_velocity","bounding_client","multitouch_active","tapped","initial_zoom_distance","zoom_center","zoom_started","touch_zoom","multi_touch_dir","wheel_delta","mac","pinching_with_trackpad","scrolling_with_trackpad","scrolling_with_mouse","double_click","canvas","rect","getBoundingClientRect","left","top","container","region","ZingTouch","Region","init","scope","set_mouse_pos","addEventListener","on_double_click","on_focus_lost","one_finger_pan","Pan","numInputs","register","event","detail","data","on_mouse_move","two_fingers_pan","set","change","three_fingers_pan","touch_zoom_delta","distance","last_zoom_distance","center","gesture","Gesture","end","inputs","state","element","on_mouse_up","start","on_mouse_down","on_mouse_wheel","preventDefault","clientX","clientY","ev","events","get_os","is_mac","console","log","deltaY","is_int","Math","abs","current","originalEvent","which","middle_mouse_button_released","rotation_delta","userAgent","navigator","platform","macosPlatforms","windowsPlatforms","iosPlatforms","os","test","n","clear","normalized_mouse_pos","INPUT","Sphere","radius","color","geometry","SphereBufferGeometry","material","MeshBasicMaterial","Mesh","_selectable_material","__get_selectable_material","original_material","stored_layers","layers","mask","ShaderMaterial","_Color","vertexShader","vert","fragmentShader","frag","Arrow","dir","cone_height","cylinder_height","cylinder_geo","CylinderBufferGeometry","translate","cone_geometry","ConeBufferGeometry","buffer_geometry","BufferGeometryUtils","mergeBufferGeometries","rotateX","quaternion","setFromUnitVectors","Vector3","scale","z","SceneManager","Scene","name","scene","scene_manager","MathUtilities","from_range_start_value","from_range_end_value","to_range_start_value","to_range_end_value","min","max","rgb","r","round","toString","g","b","points","plane","projected_point","points_on_plane","projectPoint","clone","from","to","target","t","elements","lerp","x1","x2","CameraUtilities","tmp_mat","Matrix4","tmp_vec","tmp_vec2","Plane","ray","Ray","tmp_size","tmp_unproj","applyQuaternion","NDC","v_fov","fov","PI","h_fov","atan","tan","aspect","distV","far","distH","normalize","plane_position","plane_normal","setFromNormalAndCoplanarPoint","get_forward_dir","isPerspectiveCamera","position","unproject_mouse_position","unproject","intersectPlane","zoom_scale","points_sphere","setFromPoints","world_space_center","camera_forward","project_points_on_plane","projected_points_center","box","Box3","getCenter","right","cross","inverse_mat","getInverse","applyMatrix4","size","getSize","projected_center","zoom","get_zoom_to_fit_rect","bb","isOrthographicCamera","obj_x","obj_y","object_aspect","aspect_ratio","object","getWorldPosition","project","bottom","updateProjectionMatrix","camera_utilities","Capabilities","max_anisotropy","vertex_texture_sampler_available","fp_textures_available","capabilities","EasingFunctions","sin","pow","sqrt","EventManager","queue","zoom_changed_evt","store_clickd_evt","point_selected_evt","config_changed","path_substep_completed","path_completed","go_to_store_requested_evt","resource_loaded_evt","service_clicked_evt","unit_pos_updated_evt","floor_changed_evt","on_enter_floor_navigation","on_exit_floor_navigation","on_enter_floor_selection","on_exit_floor_selection","on_enter_outside_navigation","on_exit_outside_navigation","step_selected_evt","payload","callback","fire","store_id","hit_data","step_number","step_index","resource","service","unit_data","floor_id","event_manager","AxisHelper","blueAxisMat","LineBasicMaterial","depthFunc","AlwaysDepth","blueAxisGeo","Geometry","vertices","blueAxisLine","Line","renderOrder","greenAxisMat","greenAxisGeo","greenAxisLine","redAxisMat","linewidth","redAxisGeo","computeLineDistances","redAxisLine","add","Object3D","BaseRender","context","renderer","RenderLayers","OutlineRender","webgl","main_rt","WebGLRenderTarget","rt1","rt2","compose_material","__get_compose_material","copy_material","__get_copy_material","box_blur_material","__get_box_blur_material","background_material","__get_background_material","copy_plane","PlaneGeometry","frustumCulled","copy_scene","w","h","setSize","_Screen","updateMatrix","updateMatrixWorld","enable","opaque","transparent","disable","outline","_renderer","setClearColor","clear_color","clearTarget","overrideMaterial","render","_MainTex","texture","_SampleDir","_Blur","copy_vert","copy_frag","depthTest","depthWrite","box_blur_frag","compose_frag","extensions","derivatives","Vector4","background_frag","autoClear","UI","ui_elements","_tmp_normalized_pos","autoUpdate","elem","mesh","remove","copy","update","render_ui","current_clicked_element","resize","ui","BlitMaterial","frag_shader","vert_shader","defines","_Resolution","blending","NoBlending","ClearDepthNormalMaterial","clear_depth","clear_normal","_DepthNormal","DepthNormalMaterial","_FarPlane","DepthAndNormalsRenderer","RT","clear_depth_normal_mat","depth_normal_material","graphics","__resize_RT_if_necessary","blit_clear_with_material","far_plane","Blitter","_blit_scene","_blit_material","_blit_quad","PlaneBufferGeometry","_blit_camera","OrthographicCamera","src","dst","setRenderTarget","dst_RT","Graphics","blitter","no_render","current_render_mode","generateDepthNormalTexture","depth_and_normals_renderer","WebGLRenderer","antialias","preserveDrawingBuffer","alpha","setPixelRatio","get","domElement","getMaxAnisotropy","maxVertexTextures","floatVertexTextures","new_state","constructor","on_exit","on_enter","override_mat","__apply_override_material","buffer","readRenderTargetPixels","clear_stencil","clear_alpha","offsetWidth","offsetHeight","update_size","update_native_size","src_RT","blit_with_material","blit","blob_callback","ctx","old_width","old_height","new_width","new_height","tile_width","tile_height","divisions_x","parseInt","ceil","divisions_y","ctx_2D","setViewOffset","drawImage","toBlob","clearViewOffset","blob","link","createElement","download","href","URL","createObjectURL","click","onclick","requestAnimationFrame","revokeObjectURL","a","removeAttribute","render_target","Cube","segments","BoxGeometry","Debug","Vector3_one","Vector3_zero","canvas_renderer","rt_debug","axis","position_2d","fillStyle","fillRect","clearRect","strokeStyle","beginPath","moveTo","lineTo","closePath","stroke","geo","line","pos","cube","depth","distanceTo","sub","forward_dir","forward","basic_color_vert","basic_color_frag","setFromCenterAndSize","helper","Box3Helper","sphere","SphereGeometry","side","DoubleSide","sphere1","curve","options","offset","draw_line","DEBUG","NormalRender","ObjectUtilities","xml","obj","nodeType","attributes","j","attribute","item","nodeName","nodeValue","hasChildNodes","childNodes","xml_to_json","old","PerspectiveCamera","near","GeometryBatch","batch_width","data_textures","object_names","zero_offset","write_offset","uniform_dirty_count","tmp_uploaded_data_count","needsUpdate","uniform_name","default_value_v3","src_tex","__create_rgb_texture","dst_tex","one_pixel_tex","new_data_tex","__add_data_texture","__flood_data_texture_rgb","default_value_v4","__create_rgba_texture","__flood_data_texture_rgba","__create_rgba_float_texture","object_name","vector3","use_r","use_g","use_b","obj_index","__get_object_index","data_texture","__get_data_texture","__set_pixel_rgb","one_pixel","last_accessed_index","dirty_count","vector4","use_a","__set_pixel_rgba","upload_budget","__partial_texture_data_upload","__full_texture_data_upload","texture_data","copyTextureToTexture","floor","image","v3","v4","Uint8Array","DataTexture","RGBFormat","RGBAFormat","Float32Array","RGBA","FloatType","conosle","error","src_texture","dst_texture","one_pixel_text","dispose","GeometryBatcher","batches","buffer_geometries","attr_accessor_uvs","texture_width","ceilPowerOfTwo","__init_uv_array","uv_index","vertex_count","getAttribute","count","buffer_attribute","BufferAttribute","addAttribute","upload_texture_data","uvs","geometry_batcher","RenderLoop","target_application","_frame_id","is_running","__update","on_pre_render","on_post_render","cancelAnimationFrame","AbstractLoader","resource_id","url","progress","has_finished","has_error","error_message","message","resource_container","TextureLoader","loader","load","set_resource","__update_progress","__loading_ended","__set_error","GLTFLoader","gltf","xhr","loaded","total","msg","DAELoader","ColladaLoader","TextLoader","FileLoader","CubemapLoader","CubeTextureLoader","urls","AudioLoader","listener","loop","volume","voluem","sound","Audio","audio","setBuffer","setLoop","setVolume","get_resource","JSONLoader","username","password","headers","btoa","fetch","then","__parse_to_json","__set_resource","response","ResourceContainer","resources","fire_resource_loaded","ResourceBatch","batch_name","resource_loaders","print_error","finished","TimeUtilities","start_date","end_date","startDate","moment","parseZone","endDate","duration","diff","days","asDays","days_array","date","endOf","startOf","duration_in_seconds","asSeconds","absolute_start_date","absolute_end_date","Validation","Number","GeometryUtilities","geometry_buffer","indices","positions","bar_coordinates","getX","array","getY","getZ","BufferGeometry","add_barycentric_attribute","non_indexed_geometry_buffer","Grid","grid_vert","grid_frag","plane_geometry","non_indexed_geometry","convert_to_non_indexed_geometry","rotation","Components","OVERLAY_ID","OldModule","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","JSON","parse","type","handled","assets","forEach","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","stack","overlay","createErrorOverlay","body","appendChild","getElementById","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb","CameraViewState","camera_controller","TIME","CameraDebugState","oobb","pan_speed","zoom_t","tilt_degrees","tilt_speed","vector_down_axis","vector_up_axis","vector_back_axis","vector_left_axis","tmp_dir","tmp_ray","tmp_intersection","tmp_mouse_dir","last_point","t_damping","input_enabled","reference_zoom","set_rotation_delta","prev_point","get_plane_intersection","reference_position","current_point","c","CameraMovementMode","ImmediateMode","rotation_speed","vector_forward_axis","tmp_up1","tmp_up2","tmp_forward","tmp_new_pos","tmp_quat","Quaternion","tmp_camera_target_pos","reference_rotation","clamp","min_zoom","max_zoom","lookAt","__last_reference_position","CameraController","camera_initial_rot","camera_initial_pos","current_state","current_mode","point_of_interest","normalized_zoom","vector_right_axis","tmp_right","orientation","tilt","dx_movement","dy_movement","translation_damping","translation_response","zoom_damping","zoom_response","zoom_speed_damping","rotation_damping","rotation_response_time","current_tilt","current_orientation","mode","linear_map","debug_box","update_normalized_zoom","set_state","old_orientation","build_rotation","new_tilt","setFromAxisAngle","old_tilt","conjugate","multiply","delta_x","delta_y","set_rotation","from_tilt","to_tilt","from_orientation","to_orientation","raw_orientation","new_orientation","amount","p1","p2","p3","p4","p5","p6","p7","p8","focus_camera_on_points","original_zoom","original_pos","focus_camera_on_bounding_box","target_zoom","old_zoom","old_pos","new_zoom","new_pos","debug","get_zoom_to_sphere","near_plane","geo_plane","draw_plane","applyMatrix","__get_zoom_to_show_rect","MainApplication","normal_render_mode","__init_camera","__init_camera_controller","on_resize","config","draw_axis","set_camera","set_debug_mode","application","render_loop","ViewApi","querySelector","stop","map","draw_debug_axis","register_event","on","resize_canvas","resource_loading_completed","resources_fully_loaded"],"mappings":";;AuEAA;;AASA;;;ADTA,ADAA,ADCA,AFDA;AKQA;ADGA,ACAA,AFVA,AHCA,IKSMi/B,WAAW,GAAG,IAAIT,wBAAJ,CAAoB1e,kBAApB,CAApB;AACA,IAAMof,WAAW,GAAG,IAAI3S,oBAAJ,CAAe0S,WAAf,EAA4Bnf,kBAA5B,CAApB;AAEAne,AFVA,MEUM,CAACw9B,OAAP,GAAiB;AACf11B,EAAAA,IAAI,EAAE,cAACpH,UAAD,EAAgB;AACpB,AFRJ,IFRqB82B,AFAA3B,IMgBbrB,IAAI,GAAG3wB,QAAQ,CAAC45B,aAAT,CAAuB,MAAvB,CAAX;AACA,AJfH,AFAA,QMeOp2B,MAAM,GAAGxD,QAAQ,CAAC6wB,GNfX,GEAA,QIeE,CAAwB,aAAxB,CAAb;AAEAj0B,AFTJ,AFRe,AFAA,4BMiBGG,SAAd,GAA0BF,UAAU,CAACE,SAArC;AACAH,AJlBc,AFAA,4BMkBAI,MAAd,GAAuBH,UAAU,CAACG,MAAlC;AACAJ,4BAAcK,OAAd,GAAwBJ,UAAU,CAACI,OAAnC;;AAEAqd,uBAASrW,IAAT,CAAcT,MAAd;6BJnBMyuB,AFAAA,mBEAmB,AFAA,CEAG,AFAA;AMqB5B7wB,oBAAM6C,IAAN,CAAW0sB,IAAX,EAAiBntB,MAAjB;;AACAib,oBAAMxa,IAAN,CAAWqW,GJpBN2X,AFAAA,eMoBL,IJpBwB,AFAA,CEAG,AFAA;;AMsB3B3X,IFdiBsa,mBEcRwE,SAAT;AAED,AFbF,GEHgB,wBJNTlH,AFAAA,GISM,GFTAD,AFAAA,mBEAmB,AFAA,CEAG,AFAA;AMwBlCpM,AFfY,EEeZA,OAAO,EAAE,mBAAM;AACb6T,IAAAA,WAAW,CAACG,IAAZ;AFfF,SAAKj/B,MAAL,GAAcD,SAAd;AEgBE2f,AFfF,SAAKua,cEeMze,IFfX,GAA0Bzb,EEexB,CAAmBkrB,MFfrB,CEeE;AFdF,SAAKiP,kBAAL,GAA0Bn6B,SAA1B;AEeEm/B,AFdF,IEcEA,GAAG,CAACjU,CFdDkP,MEcH,OFdF,GAAqB,IAAI/C,wBAAJ,EAArB;AEeC,AFbC,GETa,CHVI4B,KCmBZoB,YAAL,GAAoB,IAAIpB,sBAAJ,EAApB;AEeFmG,AFbA,EEaAA,OFbK9E,QEaU,EAAE,OFbjB,GAAyB,IAAI75B,KAAK,CAAC8O,OEaZ,AFbE,EAAzB;AEcEuU,AFbF,ICbmBua,AJRA7G,KGqBd+C,WEaGoE,IFbR,GAAuB,CAAvB,CEaE;AACD,AFXC,GEfa,MFeR5G,cAAL,GAAwB,IAAIt3B,KAAK,CAAC8O,OAAV,CAAkB,CAAlB,EAAoB,CAApB,EAAsB,CAAtB,CAAxB;AEaF8vB,AFZE,EEYFA,OFZO7E,OEYO,EAAE,QFZd,GAAyB,IAAI/5B,KAAK,CAAC8O,GEYpBK,IAAD,AFZW,CAAkB,CEYtB4H,AFZI,EAAoB,CAApB,EAAsB,CAAtB,CAAzB,CEYc,EAAoB;AAClCrB,AFZA,ADzBF,SCyBOgjB,kBEYQmG,AHrCD,CCyBZ,CEYA,CAAgB1vB,CFZW,GEY3B,CFZ+BnP,CEYT+W,IFZc,CAACjI,GEYrC,IFZ2B,CAAkB,CAAlB,EAAoB,CAApB,EAAsB,CAAtB,CAA3B;AEaD,AFZC,AD1BY,GGQC,MFkBR+pB,WAAL,GAAmB,KAAKH,mBAAL,CAAyBloB,KAAzB,EAAnB;AClBH,ACgCCsuB,AFbE,AHzBF,EKsCAA,OFbO9E,MEaM,EAAE,CFbb,GAAiB,KAAKD,CCnBb9gB,CJNC+d,IAAZ,EAAiB,CIMlB,EAAsB,KCgCA,CFbF,CAAuBxmB,KAAvB,EAAjB;ACnBmB,ACiCnB6tB,AFZA,AD7BY,AFEG,IKuCfA,KFZK5G,MEYM,CAACuG,AFZZ,GAAe,IAAIh+B,EEYnB,GFZwB,CAAC8O,OAAV,EAAf;AEaD,AFXC,GEvBa,MFuBRqF,IAAL,GAAY,EAAZ;ACvBmB,ACoCrB4qB,AFZE,AD/BA,AFCe,EK0CjBA,OFZO/G,cAAL,GAAsB,EEYE,AFZxB,EEY0B,sCAAM;AAChCqG,AFZA,AD/BA,IG2CAA,KFZKpE,CD/BAxB,KG2CM,CAACuG,IFZZ,GAAmB,CD/BnB,CC+BA,CAtBU,CAsBa,AD/BD,IAAIh/B,KAAK,CAACC,CG2ChC,MH3CsB,EAAtB;AEOF,ACqCC,AH1CC,AFDA,GKKa,OHJRq3B,cAAL,GAAsB,IAAIt3B,KAAK,CAAC8O,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAtB;AEMF,ACsCAie,AFdE,AD7BA,AFDA,EK4CFA,OFdOmN,CCxBFjhB,AFLEyf,AFDAzB,GG8BL,CEcU,EAAE,AFdA,ECxBd,ADwBE,CH9BA,EIMche,CJNG,IAAIjZ,GIMvB,AFLE,EFD0B,CECC,AFDAC,IECID,EG2ClBmP,CL5CI,EECmB,AFDpC,CK4CY,AH3CyBL,EG2ClBuI,KH3CQ,CAAkB,CAAlB,CG2Cf,CH3CoC,CG2ChB,AH3CL,EAAwB,CAAC,CAAzB,CAA3B;AEOF,ACqCEiY,AFbA,AD9BA,AFAA,SG8BK6K,CCxBFtD,AFNE8B,AFAAz2B,OEAL,GC8BA,AD9Be,AFAf,GG8BmB,AH9BD,CG8BlB,AD9BmBlC,AFAnB,GIMF,EFN0B,CEMD,AFNE8O,EG2CPie,EDrCSyM,GFNZ,EAAf,KG2CA,CAA+BrqB,IAA/B,EAAqCkI,QDrCd,ACqCvB,EDrCF;AACA,ACqCC,AFbC,AD9BA,AFAA,GKCa,MF6BR+iB,CCxBFyD,AFNEjF,AFAA1B,MAAL,CEAA,EFAc,CG8Bd,AD9Be,AFAf,GG8BmB,CAAnB,AD9BmBl3B,IEMrB,CFN0B,CAAC8O,CEMD,IAAI+W,EFNb,EAAf,kBEMwB,EAA1B;AALqB,AC4CrBnb,AFbE,AD/BA,AFCA,EK2CFA,KAAK,EAAE,AFbAwuB,CD/BAL,AFCA1B,WEDL,CFCA,EEDmB,CFCC,CK2CT,CFbX,AH9BA,CEDuBn3B,EC+BG,GD/BE,CC+BEA,AD/BD8O,KC+BM,CAACkqB,CD/BjB,EAAnB,OC+B0B,EAA1B;ACxBF,ACsCEsF,AFbF,AD7BE,AFDA,IK2CAA,KFbGlG,CD7BEU,AFDA1B,KK2CM,CAAC1sB,IL3CZ,CK2CA,AH1CA,EFDkB,CECC,AFDnB,GG8BF,CD7ByB1K,EC6BC,GD7BI,CC6BAA,AD7BC8O,KC6BI,CAACA,CD7Bf,EAAnB,IC6BwB,EAA1B;AEcC,AFbD,AD5BE,AFDA,GKJa,MFiCVyqB,CD5BER,AFDA1B,QECL,GAAgB,IAAIr3B,CFDpB,GAAwB,CECC,CAACg5B,EFDEh5B,CG6B9B,GAAiC,CH7BE,CAAC8O,EG6BC9O,AD5BnB,EAAhB,GC4BwC,AH7BhB,CG6BiB8O,AH7BC,CAAlB,EAAoB,CAAC,CAArB,EG6BO,AH7BgB,CAAvB,CG6B1B,AH7BE;AK4CF2vB,AFXA,AD/BE,AFDA,EK2CFA,IAAI,EAAE,CFXDpE,CD/BEpB,AFDA3B,cK2CK,AL3CV,GAAwB,CGgC1B,GAA2B,AD/BzB,AFD4Bt3B,CGgC9B,ED/B+B,EFDI,CAAC8O,CECD9O,KAAK,CAAC8O,AFDf,CAAkB,CAAlB,EAAoB,CAApB,EECK,AFDiB,CAAtB,CECxB,AFDA;AK4CAwvB,AFXF,AD9Cc,AFcZ,IK2CAA,KFXGhE,CHhCE/C,KK2CM,CAACkH,IAAZ,ML3CA,GGgCF,AHhC0B,GGgCE,CHhCEz+B,EGgC9B,GHhCmC,CAAC8O,OAAV,CAAkB,CAAlB,EAAoB,CAApB,EAAsB,CAAC,CAAvB,CAAxB;AK4CD,AFVD,ADjCC,AFAC,GKPa,MFwCVyrB,CHjCE/C,WGiCP,GAAoB,EHjClB,EIEK,AD+BP,CHjC0B,IAAIx3B,KAAK,CAAC8O,OAAV,CAAkB,CAAC,CAAnB,EAAqB,CAArB,EAAuB,CAAvB,CAAxB;AIGFoQ,AC0CAmf,AFXA,AHhCE,EK2CFA,OFXK7D,CHhCE/C,GK2CI,EAAE4G,EL3CX,GAAe,EGgCjB,EHhCqBr+B,CICZk7B,AD+BY,CEzCN,AFyCf,CAtCY,CAwCZ,CHlC0B,CAACpsB,IIC3B,CAAmB,EJDF,EAAf,CICsB+uB,kBAAxB;AC2CAI,AL3CE,EK2CFA,MAAM,EAAEz8B,AL3CDk2B,OAAL,GAAe,IAAI13B,KAAK,CAACwR,GKVZ,ALUE,EAAf;AIEF,AC0CAmb,AFVA,AHhCE,EK0CFA,OFVK8N,CHhCE9C,CIAFmG,SC0Ca,EAAExO,ED1CpB,EJAE,CGgCF,EHhC0B,CGgCA,GHhCItvB,CGgC9B,IHhCmC,CAAC8O,OAAV,EAAxB;AKZa,AF6Cf,AHhCE,CKbJ,QF6CO5M,CHhCE01B,SGgCP,GAAkB,CAAlB,AHhCE,GAAqB,GEHdf,CFGkB72B,KAAK,CAACC,OAAV,EAArB,GEH0B;AEG5B,ADkCA,ADpCE42B,AFIA,MEJAA,GCoCG6D,CHhCE7C,CIFFkG,S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","file":"api.2fb5b1b6.js","sourceRoot":"..\\app","sourcesContent":["export default class BaseApplication\r\n{\r\n\tstart() {}\r\n\tend() {}\r\n\tupdate() {}\r\n\ton_post_render() {}\r\n\ton_pre_render() {}\r\n\tresources_fully_loaded() {}\r\n}\r\n","class CameraManager {\r\n\tconstructor()\r\n\t{\r\n\t\tthis._current = undefined;\r\n\t}\r\n\r\n\tset current(camera)\r\n\t{\r\n\t\tthis._current = camera;\r\n\t}\r\n\r\n\tget current()\r\n\t{\r\n\t\treturn this._current;\r\n\t}\r\n}\r\n\r\nconst camera_manager = new CameraManager();\r\nmodule.exports = camera_manager;\r\n","class Screen {\r\n\tconstructor()\r\n\t{\r\n\t\tthis.width = 1;\r\n\t\tthis.height = 1;\r\n\t\tthis.width_height = new THREE.Vector2(this.width, this.height);\r\n\r\n\t\tthis.screen_materials = [];\r\n\r\n\t\tthis.native_width = this.width;\r\n\t\tthis.native_height = this.height;\r\n\r\n\t\tthis.pixel_size = new THREE.Vector2(1/this.width, 1/this.height);\r\n\t}\r\n\r\n\tupdate_size(width, height)\r\n\t{\r\n\t\tthis.width = width;\r\n\t\tthis.height = height;\r\n\r\n\t\tthis.pixel_size = new THREE.Vector2(1/this.width, 1/this.height) ;\r\n\r\n\t\tthis.width_height.x = width  ;\r\n\t\tthis.width_height.y = height ;\r\n\r\n\t\tlet i = this.screen_materials.length;\r\n\t\twhile(i--)\r\n\t\t{\r\n\t\t\tthis.screen_materials[i].uniforms._ScreenSize.value = this.width_height;\r\n\t\t}\r\n\t}\r\n\r\n\tapply_pixel_density_v2(vector2)\r\n\t{\r\n\t\tvector2.multiplyScalar(1/window.devicePixelRatio);\r\n\r\n\t\treturn vector2;\r\n\t}\r\n\tapply_pixel_density(value)\r\n\t{\r\n\t\treturn value * (1/window.devicePixelRatio);\r\n\t}\r\n\tupdate_native_size()\r\n\t{\r\n\t\tthis.native_width = window.innerWidth;\r\n\t\tthis.native_height = window.innerHeight;\r\n\t}\r\n\r\n\tadd_screen_material(mat)\r\n\t{\r\n\t\tthis.screen_materials.push(mat);\r\n\t\tmat.uniforms._ScreenSize.value = this.width_height;\r\n\t}\r\n\tremove_screen_material(mat)\r\n\t{\r\n    let index = this.screen_materials.indexOf(mat);\r\n    if (index > -1) {\r\n      this.screen_materials.splice(index, 1);\r\n    }\r\n\t}\r\n\r\n\tget_pixel_size()\r\n\t{\r\n\t\treturn this.pixel_size;\r\n\t}\r\n\r\n\tget aspect_ratio()\r\n\t{\r\n\t\treturn this.width/this.height;\r\n\t}\r\n\r\n\r\n}\r\n\r\nexport default new Screen();\r\n","/*\r\n\r\n  A configuration class used as a singleton\r\n\r\n*/\r\n\r\nclass Configuration {\r\n  constructor(parameters = {}) {\r\n\r\n    this.dpr = window.devicePixelRatio ? window.devicePixelRatio : 1;\r\n    this.is_mobile = false;\r\n    this.is_ios = false;\r\n    this.is_ipad = false;\r\n\r\n    this.vertex_image_unit_supported = true;\r\n\r\n    this.min_zoom_distance = 3000;\r\n\r\n    this.max_zoom_distance = 40000;\r\n    this.max_zoom_distance_scale = 1.1;\r\n    this.zoom_speed = 0.1;\r\n\r\n\r\n\r\n    this.use_fxaa = false;\r\n    this.use_ssaa = true;\r\n\r\n\r\n\r\n    this.background_color = new THREE.Color(0.768,0.768,0.768);\r\n\r\n\r\n\r\n\r\n    //TOUCH\r\n    this.touch_sensitivity = 1.5;\r\n    this.zoom_sensitivity = 0.7;\r\n    this.spin_sensitivity = 2;\r\n    this.three_finger_rotation_speed = 3;\r\n    this.three_finger_allowed_x_rotation_offset = 30;\r\n    this.three_finger_allowed_y_rotation_offset = 20;\r\n\r\n\r\n    this.use_touch_gestures = false;\r\n\r\n\r\n    this.texture_float_supported = false;\r\n\r\n    this.use_ortographic = true;\r\n\r\n    this.hover_enabled = false;\r\n    this.rotation_enabled = false;\r\n\r\n    this.transparency_amount = 0.2;\r\n\r\n    this.show_debug_sphere_on_floor_selection = false;\r\n    this.show_debug_sphere_on_steps_in_floor = false;\r\n    this.display_cleanup_log = false;\r\n\r\n\r\n    this.navigation_speed_damping = 0.74;\r\n    this.navigation_speed = 200;\r\n    this.out_of_bounds_force = 1.5;\r\n    this.mouse_zoom_speed = 0.05;\r\n    this.touch_zoom_speed = 0.5;\r\n\r\n\r\n  }\r\n\r\n\r\n\r\n\r\n\r\n\r\n  from_json(json)\r\n  {\r\n\r\n\r\n  }\r\n}\r\n\r\nconst configuration = new Configuration();\r\nmodule.exports = configuration;\r\n","class Time\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.___time = new THREE.Clock();\r\n\t\tthis.__delta_time = 0;\r\n\t\tthis.__elapsed_time = 0;\r\n\t\tthis.__allocated_time = new THREE.Vector2(0,0);\r\n\t}\r\n\r\n\r\n\tget delta_time()\r\n\t{\r\n\t\treturn this.__delta_time < 0.4? this.__delta_time : 0.016;\r\n\t}\r\n\tget elapsed_time()\r\n\t{\r\n\t\treturn this.__elapsed_time;\r\n\t}\r\n\tget shader_time()\r\n\t{\r\n\t\tthis.__allocated_time.x = this.delta_time;\r\n\t\tthis.__allocated_time.y = this.elapsed_time;\r\n\t\treturn  this.__allocated_time;\r\n\t}\r\n\r\n\t__update()\r\n\t{\r\n\t\tthis.__delta_time = this.___time.getDelta();\r\n\t\tthis.__elapsed_time = this.___time.getElapsedTime();\r\n\t}\r\n}\r\n\r\nconst time = new Time();\r\nmodule.exports = time;\r\n\r\n","export class KeyboardInput\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.ctrlz_pressed = false;\r\n\t\tthis.ctrlz_fired = false;\r\n\r\n\t\tthis.keys = [];\r\n\t}\r\n\r\n\tinit()\r\n\t{\r\n\t\tdocument.onkeydown \t= this.on_key_down.bind(this);\r\n\t\tdocument.onkeyup \t\t= this.on_key_up.bind(this);\r\n\t\tdocument.onkeypress = this.on_key_press.bind(this);\r\n\t}\r\n\r\n\ton_key_down(e)\r\n\t{\r\n\t\tif(e.keyCode == 90 && e.ctrlKey && !this.ctrlz_fired)\r\n    {\r\n    \tthis.ctrlz_pressed = true;\r\n    \tthis.ctrlz_fired = true;\r\n    } \r\n    if(e.key)\r\n    {\r\n    \tthis.press_key(e.key);\r\n    }\r\n\t}\r\n\ton_key_press(e)\r\n\t{\r\n\t\t\r\n\t}\r\n\ton_key_up(e)\r\n\t{\r\n\t\tthis.release_keys();\r\n\t}\r\n\r\n\tclear()\r\n\t{\r\n\t\tthis.ctrlz_pressed = false;\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tthis.keys[i].pressed = false;\r\n\t\t}\r\n\t}\r\n\r\n\trelease_keys()\r\n\t{\r\n\t\tthis.ctrlz_fired = false;\r\n\t\t\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tthis.keys[i].fired = false;\r\n\t\t\tthis.keys[i].down = false;\r\n\t\t}\r\n\t}\r\n\r\n\tpress_key(key)\r\n\t{\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tif(this.keys[i].key_name === key && !this.keys[i].fired)\r\n\t\t\t{\r\n\t\t\t\tthis.keys[i].pressed = true;\r\n\t\t\t\tthis.keys[i].down = true;\r\n\t\t\t\tthis.keys[i].fired = true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tkey_is_pressed(key)\r\n\t{\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tif(this.keys[i].key_name === key)\r\n\t\t\t{\r\n\t\t\t\treturn this.keys[i].pressed;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tkey_is_down(key)\r\n\t{\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tif(this.keys[i].key_name === key)\r\n\t\t\t{\r\n\t\t\t\treturn this.keys[i].down;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tregister_key(key)\r\n\t{\r\n\t\tthis.keys.push(\r\n\t\t{\r\n\t\t\tkey_name: key,\r\n\t\t\tpressed: false,\r\n\t\t\tdown: false,\r\n\t\t\tup: false,\r\n\t\t\tfired: false\r\n\r\n\t\t});\r\n\t}\r\n\tunregister_key(key_name)\r\n\t{\r\n\t\tlet key = undefined;\r\n\t\tfor(let i=0; i< this.keys.length; i++)\r\n\t\t{\r\n\t\t\tif(this.keys[i].key_name === key_name)\r\n\t\t\t\tkey = this.keys[i];\r\n\t\t}\r\n\r\n\t\tlet index = this.keys.indexOf(key);\r\n    if (index > -1) {\r\n      this.keys.splice(index, 1);\r\n    }\r\n\t}\r\n\r\n}\r\n\r\nconst keyboard_input = new KeyboardInput();\r\nmodule.exports = keyboard_input;","import Screen from '/Screen';\r\nimport Configuration from '/Configuration';\r\nimport Time from '/Time';\r\nimport KeyboardInput from '/KeyboardInput';\r\n\r\nclass Input {\r\n\tconstructor() {\r\n\t\tthis.mouse_pos = new THREE.Vector2();\r\n\t\tthis.last_mouse_pos = new THREE.Vector2();\r\n\t\tthis.mouse_dir = new THREE.Vector2();\r\n\r\n\r\n\t\tthis.__clicked_time = 0;\r\n\t\tthis.__elapsed_time = 0;\r\n\t\tthis.__delta_time = 0;\r\n\r\n\t\tthis.is_mouse_down = false;\r\n\t\tthis.is_mouse_up = false;\r\n\r\n\t\tthis.rotation_angle = 0;\r\n\r\n\t\tthis._normalized_mouse_pos = new THREE.Vector2(0, 0);\r\n\r\n\t\tthis.left_mouse_button_down = false;\r\n\t\tthis.left_mouse_button_pressed = false;\r\n\t\tthis.left_mouse_button_released = false;\r\n\t\tthis.middle_mouse_button_down = false;\r\n\t\tthis.right_mouse_button_down = false;\r\n\t\tthis.right_mouse_button_pressed = false;\r\n\t\tthis.right_mouse_button_released = false;\r\n\r\n\t\tthis.mousewheel = 0;\r\n\r\n\t\tthis.previous_scale = 0;\r\n\t\tthis.previous_rotation = 0;\r\n\t\tthis.previous_rotation_dirty = true;\r\n\r\n\t\tthis.mouse_str = \"mouse\";\r\n\r\n\t\tthis.tmp_mouse_velocity = new THREE.Vector2();\r\n\t\tthis.bounding_client = new THREE.Vector2();\r\n\r\n\t\tthis.multitouch_active = false;\r\n\r\n\t\tthis.tapped = false;\r\n\t\tthis.initial_zoom_distance = 100;\r\n\t\tthis.zoom_center = new THREE.Vector2();\r\n\t\tthis.zoom_started = false;\r\n\t\tthis.touch_zoom = 1;\r\n\r\n\t\tthis.multi_touch_dir = new THREE.Vector2();\r\n\t\tthis.wheel_delta = 0;\r\n\r\n\t\tthis.mac = 'mac';\r\n\t\tthis.pinching_with_trackpad = false;\r\n\t\tthis.scrolling_with_trackpad = false;\r\n\t\tthis.scrolling_with_mouse = false;\r\n\r\n\t\tthis.double_click = false;\r\n\r\n\t\tthis.canvas = undefined;\r\n\t}\r\n\r\n\tmouse_is_within_bounds() {\r\n\t\tlet rect = this.canvas.getBoundingClientRect();\r\n\r\n\t\treturn this.mouse_pos.x > rect.left &&\r\n\t\t\tthis.mouse_pos.x < rect.left + rect.width &&\r\n\t\t\tthis.mouse_pos.y > rect.top &&\r\n\t\t\tthis.mouse_pos.y < rect.top + rect.height;\r\n\t}\r\n\r\n\tinit(container, canvas) {\r\n\t\tthis.canvas = canvas;\r\n\r\n\t\tlet region = new ZingTouch.Region(container, false, false);\r\n\t\tKeyboardInput.init();\r\n\r\n\t\tlet scope = this;\r\n\r\n\t\tregion.bind(container, 'tap', function (e) {\r\n\t\t\tscope.tapped = true;\r\n\t\t\tscope.set_mouse_pos(e);\r\n\r\n\t\t});\r\n\r\n\t\twindow.addEventListener('dblclick', this.on_double_click.bind(this));\r\n\r\n\t\tcontainer.addEventListener('mouseleave', this.on_focus_lost.bind(this));\r\n\r\n\t\t// region.bind(container, 'pan', function(e){\r\n\t\t// \tscope.on_mouse_move(e);\r\n\t\t// \tconsole.log(\"PAN\");\r\n\t\t// });\r\n\t\tlet one_finger_pan = new ZingTouch.Pan({ numInputs: 1 });\r\n\t\tregion.register(\"one_finger_pan\", one_finger_pan);\r\n\t\tregion.bind(container, \"one_finger_pan\", (event) => {\r\n\t\t\tif (event.detail.data.length > 0) {\r\n\t\t\t\t// scope.multi_touch_dir.set(event.detail.data[0].change.x, event.detail.data[0].change.y)\r\n\t\t\t\t// scope.multi_touch_dir.multiplyScalar(scope.__delta_time);\r\n\t\t\t\tscope.on_mouse_move(event);\r\n\t\t\t}\r\n\r\n\t\t})\r\n\t\tlet two_fingers_pan = new ZingTouch.Pan({ numInputs: 2 });\r\n\t\tregion.register(\"two_fingers_pan\", two_fingers_pan);\r\n\t\tregion.bind(container, \"two_fingers_pan\", (event) => {\r\n\t\t\tif (event.detail.data.length > 0) {\r\n\r\n\t\t\t\t// scope.multi_touch_dir.set(event.detail.data[0].change.x, event.detail.data[0].change.y)\r\n\t\t\t\t// scope.multi_touch_dir.multiplyScalar(scope.__delta_time);\r\n\t\t\t\tscope.multi_touch_dir.set(event.detail.data[0].change.x, event.detail.data[0].change.y)\r\n\t\t\t\tscope.multi_touch_dir.multiplyScalar(scope.__delta_time);\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tlet three_fingers_pan = new ZingTouch.Pan({ numInputs: 3 });\r\n\t\tregion.register(\"three_fingers_pan\", three_fingers_pan);\r\n\t\tregion.bind(container, \"three_fingers_pan\", (event) => {\r\n\t\t\tif (event.detail.data.length > 0) {\r\n\t\t\t\tscope.multi_touch_dir.set(event.detail.data[0].change.x, event.detail.data[0].change.y)\r\n\t\t\t\tscope.multi_touch_dir.multiplyScalar(scope.__delta_time);\r\n\t\t\t}\r\n\r\n\t\t})\r\n\r\n\t\tregion.bind(container, 'distance', function (e) {\r\n\r\n\t\t\tif (!scope.zoom_started) {\r\n\t\t\t\tscope.zoom_started = true;\r\n\t\t\t\tscope.touch_zoom_delta = 0;\r\n\t\t\t\tscope.initial_zoom_distance = e.detail.distance;\r\n\t\t\t\tscope.last_zoom_distance = e.detail.distance;\r\n\r\n\t\t\t\tscope.zoom_center.set(e.detail.center.x, e.detail.center.y);\r\n\t\t\t\tscope.mouse_pos.set(e.detail.center.x, e.detail.center.y);\r\n\t\t\t}\r\n\t\t\tscope.touch_zoom_delta = e.detail.distance - scope.last_zoom_distance;\r\n\t\t\tscope.last_zoom_distance = e.detail.distance;\r\n\t\t\tscope.touch_zoom = 1;\r\n\t\t}, false);\r\n\r\n\t\tlet gesture = new ZingTouch.Gesture();\r\n\t\tgesture.end = (inputs, state, element) => { scope.on_mouse_up(inputs) }\r\n\t\tgesture.start = (inputs, state, element) => { scope.on_mouse_down(inputs) }\r\n\t\tregion.register('shortTap', gesture);\r\n\r\n\t\tregion.bind(container, 'shortTap', function (e) {\r\n\t\t});\r\n\r\n\t\twindow.addEventListener('wheel', this.on_mouse_wheel.bind(this))\r\n    container.addEventListener( 'contextmenu', (event)=>{event.preventDefault()}, false );\r\n\r\n\t\tcontainer.addEventListener(\"mousemove\", (event) => {\r\n\t\t\tthis.mouse_pos.x = event.clientX;\r\n\t\t\tthis.mouse_pos.y = event.clientY;\r\n\t\t\tthis.scrolling_with_mouse = false;\r\n\t\t\tthis.scrolling_with_trackpad = false;\r\n\t\t\tthis.pinching_with_trackpad = false;\r\n\t\t});\r\n\t}\r\n\r\n\tset_mouse_pos(ev) {\r\n\t\tthis.mouse_pos.x = ev.detail.events[0].clientX;\r\n\t\tthis.mouse_pos.y = ev.detail.events[0].clientY;\r\n\t}\r\n\r\n\tget normalized_mouse_pos() {\r\n\t\tthis._normalized_mouse_pos.x = (this.mouse_pos.x / Screen.width) * 2.0 - 1;\r\n\t\tthis._normalized_mouse_pos.y = -1 * ((this.mouse_pos.y / Screen.height) * 2.0 - 1);\r\n\t\treturn this._normalized_mouse_pos;\r\n\t}\r\n\r\n\tget NDC() {\r\n\t\treturn this.normalized_mouse_pos;\r\n\t}\r\n\r\n\tis_mac() {\r\n\t\treturn this.get_os() === this.mac;\r\n\t}\r\n\r\n\ton_double_click(event) {\r\n\t\tthis.double_click = true;\r\n\t}\r\n\r\n\ton_mouse_wheel(event) {\r\n\r\n\r\n\t\tthis.mouse_pos.x = event.clientX;\r\n\t\tthis.mouse_pos.y = event.clientY;\r\n\r\n\t\t// User is using a mac\r\n\t\tif (this.is_mac()) {\r\n\t\t\t// User is pinching\r\n\t\t\tif (event.ctrlKey) {\r\n\t\t\t\t// Negative values means pinch in.\r\n\t\t\t\t// Positive values means pinch out.\r\n\t\t\t\tconsole.log(\"Pinching with a touchpad\", event.deltaY)\r\n\t\t\t\tthis.pinching_with_trackpad = true;\r\n\t\t\t\tthis.scrolling_with_trackpad = false;\r\n\t\t\t\tthis.scrolling_with_mouse = false;\r\n\t\t\t\t// User is scrolling\r\n\t\t\t} else {\r\n\t\t\t\t// User is using the touchpad\r\n\t\t\t\tif (this.is_int(event.deltaY)) {\r\n\t\t\t\t\t// Negative values means scroll up\r\n\t\t\t\t\t// Positive values means scroll down\r\n\t\t\t\t\t// console.log(\"Scrolling with a touchpad\", (event.deltaY))\r\n\t\t\t\t\t// 350 is aprox the maximum value of deltaY on touchpad scroll\r\n\t\t\t\t\tthis.pinching_with_trackpad = false;\r\n\t\t\t\t\tthis.scrolling_with_trackpad = true;\r\n\t\t\t\t\tthis.scrolling_with_mouse = false;\r\n\r\n\t\t\t\t\tthis.wheel_delta = 1 - (event.deltaY / 350) * 2.0 - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Negative values means scroll up\r\n\t\t\t\t\t// Positive values means scroll down\r\n\t\t\t\t\t// console.log(\"Scrolling with a mouse\", event.deltaY)\r\n\t\t\t\t\tthis.pinching_with_trackpad = false;\r\n\t\t\t\t\tthis.scrolling_with_trackpad = false;\r\n\t\t\t\t\tthis.scrolling_with_mouse = true;\r\n\r\n\t\t\t\t\tthis.wheel_delta = event.deltaY / Math.abs(event.deltaY);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//probably windows\r\n\t\t\tthis.pinching_with_trackpad = false;\r\n\t\t\tthis.scrolling_with_trackpad = false;\r\n\t\t\tthis.scrolling_with_mouse = true;\r\n\r\n\t\t\tthis.wheel_delta = event.deltaY / Math.abs(event.deltaY);\r\n\t\t}\r\n\t}\r\n\r\n\ton_mouse_down(inputs) {\r\n\t\tthis.mouse_pos.x = inputs[0].current.clientX;\r\n\t\tthis.mouse_pos.y = inputs[0].current.clientY;\r\n\r\n\t\tthis.multitouch_active = inputs.length > 1;\r\n\r\n\t\tthis.mouse_dir.x = 0;\r\n\t\tthis.mouse_dir.y = 0;\r\n\r\n\r\n\t\tthis.__clicked_time = this.__elapsed_time;\r\n\t\tthis.is_mouse_down = true;\r\n\t\tthis.is_mouse_up = false;\r\n\r\n\t\tswitch (inputs[0].current.originalEvent.which) {\r\n\t\t\tcase 1:\r\n\t\t\t\tthis.left_mouse_button_down = true;\r\n\t\t\t\tthis.left_mouse_button_pressed = true;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2: this.middle_mouse_button_down = true; break;\r\n\t\t\tcase 3:\r\n\t\t\t\tthis.right_mouse_button_down = true;\r\n\t\t\t\tthis.right_mouse_button_pressed = true;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault: this.left_mouse_button_down = true; this.left_mouse_button_pressed = true; break;\r\n\t\t}\r\n\r\n\r\n\t\tthis.wheel_delta = 0;\r\n\t\tthis.previous_scale = 0;\r\n\t\tthis.previous_rotation = 0;\r\n\r\n\r\n\t}\r\n\r\n\tmouse_clicked() {\r\n\t\treturn this.tapped;\r\n\t}\r\n\r\n\ton_mouse_up(inputs) {\r\n\t\t// this.left_mouse_button_released = true;\r\n\t\tthis.multitouch_active = inputs ? (inputs.length > 1) : false;\r\n\t\tthis.is_mouse_up = true;\r\n\t\tthis.zoom_started = false;\r\n\t\tthis.touch_zoom = 1;\r\n\t\tthis.mouse_dir.x = 0;\r\n\t\tthis.mouse_dir.y = 0;\r\n\t\tthis.previous_scale = 0;\r\n\t\tthis.previous_rotation = 0;\r\n\t\tthis.wheel_delta = 0;\r\n\r\n\t\tthis.left_mouse_button_down = false;\r\n\t\tthis.middle_mouse_button_down = false;\r\n\t\tthis.right_mouse_button_down = false;\r\n\t\tif (inputs) {\r\n\t\t\tswitch (inputs[0].current.originalEvent.which) {\r\n\t\t\t\tcase 1:\r\n\t\t\t\t\tthis.left_mouse_button_released = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 2:\r\n\t\t\t\t\tthis.middle_mouse_button_released = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3:\r\n\t\t\t\t\tthis.right_mouse_button_released = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthis.left_mouse_button_released = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.is_mouse_down = false;\r\n\t\tthis.previous_rotation_dirty = true;\r\n\t\tthis.rotation_delta = 0;\r\n\t}\r\n\r\n\r\n\ton_focus_lost() {\r\n\t\tthis.on_mouse_up();\r\n\t\tthis.left_mouse_button_released = true;\r\n\t\tthis.middle_mouse_button_released = true;\r\n\t\tthis.right_mouse_button_released = true;\r\n\t\tthis.left_mouse_button_released = true;\r\n\r\n\t}\r\n\r\n\ttime_since_last_mouse_down() {\r\n\t\treturn this.__elapsed_time - this.__clicked_time;\r\n\t}\r\n\r\n\ton_mouse_move(event) {\r\n\t\tif (event.detail.data.length > 0) {\r\n\t\t\tthis.set_mouse_pos(event);\r\n\t\t\tthis.mouse_dir.set(event.detail.data[0].change.x, event.detail.data[0].change.y)\r\n\t\t\t// this.mouse_dir.x *=  Screen.height / Screen.width;\r\n\r\n\t\t\t// this.mouse_dir.multiplyScalar(this.__delta_time/window.devicePixelRatio);\r\n\t\t}\r\n\t}\r\n\r\n\tget_os() {\r\n\t\tvar userAgent = window.navigator.userAgent,\r\n\t\t\tplatform = window.navigator.platform,\r\n\t\t\tmacosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'],\r\n\t\t\twindowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'],\r\n\t\t\tiosPlatforms = ['iPhone', 'iPad', 'iPod'],\r\n\t\t\tos = null;\r\n\r\n\t\tif (macosPlatforms.indexOf(platform) !== -1) {\r\n\t\t\tos = 'mac';\r\n\t\t} else if (iosPlatforms.indexOf(platform) !== -1) {\r\n\t\t\tos = 'ios';\r\n\t\t} else if (windowsPlatforms.indexOf(platform) !== -1) {\r\n\t\t\tos = 'windows';\r\n\t\t} else if (/Android/.test(userAgent)) {\r\n\t\t\tos = 'android';\r\n\t\t} else if (!os && /Linux/.test(platform)) {\r\n\t\t\tos = 'linux';\r\n\t\t}\r\n\r\n\t\treturn os;\r\n\t}\r\n\r\n\tis_int(n) {\r\n\t\treturn n % 1 === 0;\r\n\t}\r\n\r\n\tclear() {\r\n\r\n\t\tthis.__elapsed_time = Time.elapsed_time;\r\n\t\tthis.__delta_time = Time.delta_time;\r\n\t\tthis.is_mouse_up = false;\r\n\t\tthis.wheel_delta = 0;\r\n\t\tthis.rotation_delta = 0;\r\n\r\n\t\tthis.double_click = false;\r\n\r\n\r\n\t\tthis.tapped = false;\r\n\t\tthis.mouse_dir.multiplyScalar(0);\r\n\t\tthis.multi_touch_dir.multiplyScalar(0);\r\n\t\tthis.left_mouse_button_pressed = false;\r\n\t\tthis.left_mouse_button_released = false;\r\n\r\n\t\tthis.right_mouse_button_pressed = false;\r\n\t\tthis.right_mouse_button_released = false;\r\n\t\tKeyboardInput.clear();\r\n\r\n\t}\r\n\r\n}\r\n\r\nconst INPUT = new Input();\r\nmodule.exports = INPUT;\r\n","export default class Sphere extends THREE.Mesh\r\n{\r\n\tconstructor(radius, color)\r\n\t{\r\n    color = color || \"#FF0000\";\r\n    radius = radius || 1;\r\n    let geometry = new THREE.SphereBufferGeometry( radius, 64, 64);\r\n    let material = new THREE.MeshBasicMaterial( {color: color} );\r\n\t\tsuper(geometry, material);\r\n\t}\r\n}","module.exports=\"#define GLSLIFY 1\\nvoid main()\\n{\\n  vec3 pos = position;\\n  mat4 MVP = projectionMatrix * modelViewMatrix;\\n\\n  gl_Position = MVP * vec4( pos, 1.0 );\\n  //gl_Position.zw -= 0.1;\\n}\";","module.exports=\"#define GLSLIFY 1\\nuniform vec3 _Color;\\n\\nvoid main()\\n{\\n    gl_FragColor = vec4(_Color, 1.0);\\n}\";","import vert from '/editor/shaders/object_picker_vert';\r\nimport frag from '/editor/shaders/object_picker_frag';\r\nexport default class Mesh extends THREE.Mesh\r\n{\r\n\tconstructor(geometry, material)\r\n\t{\r\n\t\tsuper(geometry, material);\r\n\r\n\t\tthis._selectable_material = this.__get_selectable_material();\r\n\t\tthis.original_material = this.material;\r\n\t\tthis.stored_layers = this.layers.mask;\r\n\t}\r\n\r\n\t__get_selectable_material()\r\n\t{\r\n\t\treturn new THREE.ShaderMaterial({\r\n\t\t\tuniforms: {\r\n\t\t\t\t_Color: {value: new THREE.Color()}\r\n\t\t\t},\r\n\t\t\tvertexShader: vert,\r\n      fragmentShader: frag\r\n\t\t});\r\n\t}\r\n\r\n\trestore_material()\r\n\t{\r\n\t\tthis.material = this.original_material;\r\n\t}\r\n\r\n\tstore_layer_state()\r\n\t{\r\n\t\tthis.stored_layers = this.layers.mask;\r\n\t}\r\n\trestore_layer_state()\r\n\t{\r\n\t\tthis.layers.mask = this.stored_layers;\r\n\t}\r\n\r\n\tget selectable_material()\r\n\t{\r\n\t\treturn this._selectable_material;\r\n\t}\r\n}\r\n","import Mesh from '/Mesh';\r\n\r\nexport default class Arrow extends Mesh\r\n{\r\n\tconstructor(color, length, dir)\r\n\t{\r\n\t\tcolor = color || \"#FF0000\";\r\n\t\tlength = length || 1;\r\n\r\n\t\tlet cone_height = 0.4;\r\n\t\tlet cylinder_height = length - cone_height;\r\n\t\tlet cylinder_geo = new THREE.CylinderBufferGeometry( 0.01, 0.01, cylinder_height, 32 );\r\n\t\tcylinder_geo.translate(0,cylinder_height/2,0);\r\n\t\tlet cone_geometry = new THREE.ConeBufferGeometry( 0.1, cone_height, 32 );\r\n\t\tcone_geometry.translate(0, cylinder_height+cone_height/2, 0);\r\n\t  let buffer_geometry = THREE.BufferGeometryUtils.mergeBufferGeometries([cylinder_geo, cone_geometry]);\r\n\t  buffer_geometry.rotateX(3.14/2);\r\n    let material = new THREE.MeshBasicMaterial( {color: color} );\r\n\t\tsuper(buffer_geometry, material);\r\n\r\n\t\tif(dir)\r\n\t\t\tthis.quaternion.setFromUnitVectors(new THREE.Vector3(0,0,1), dir);\r\n\t}\r\n\r\n\tset dir(dir)\r\n\t{\r\n\t\tthis.quaternion.setFromUnitVectors(new THREE.Vector3(0,0,1), dir);\r\n\t}\r\n\tset length(value)\r\n\t{\r\n\t\tthis.scale.z = value;\r\n\t}\r\n}\r\n","class SceneManager\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis._current = new THREE.Scene();\r\n\t\tthis._current.name = \"default_scene\";\r\n\r\n\t}\r\n\r\n\tadd_scene(name)\r\n\t{\r\n\r\n\t}\r\n\r\n\tget current()\r\n\t{\r\n\t\treturn this._current;\r\n\t}\r\n\r\n\tset current(scene)\r\n\t{\r\n\t\tthis._current = scene;\r\n\t}\r\n}\r\n\r\nconst scene_manager = new SceneManager();\r\nmodule.exports = scene_manager;","export default class MathUtilities\r\n{\r\n\tconstructor(){}\r\n\r\n\tstatic linear_map(value,\r\n             from_range_start_value,\r\n             from_range_end_value,\r\n             to_range_start_value,\r\n             to_range_end_value)\r\n  {\r\n      return ((value - from_range_start_value)/ (from_range_end_value - from_range_start_value)) * (to_range_end_value - to_range_start_value) + to_range_start_value;\r\n  }\r\n\r\n  static between(value, min, max)\r\n  {\r\n\t\treturn (value >= min && value <= max)\r\n\r\n  }\r\n\r\n  static rgb_to_hex(rgb) {\r\n    rgb.r = Math.round(rgb.r * 255).toString(16);\r\n    rgb.g = Math.round(rgb.g * 255).toString(16);\r\n    rgb.b = Math.round(rgb.b * 255).toString(16);\r\n\r\n    if (rgb.r.length == 1)\r\n      rgb.r = \"0\" + rgb.r;\r\n    if (rgb.g.length == 1)\r\n      rgb.g = \"0\" + rgb.g;\r\n    if (rgb.b.length == 1)\r\n      rgb.b = \"0\" + rgb.b;\r\n\r\n    return \"#\" + rgb.r + rgb.g + rgb.b;\r\n  }\r\n\r\n  static project_points_on_plane(points, plane)\r\n  {\r\n    let projected_point = new THREE.Vector3();\r\n    let points_on_plane = [];\r\n    for(let i=0; i< points.length; i++)\r\n    {\r\n      plane.projectPoint(points[i], projected_point);\r\n      points_on_plane.push(projected_point.clone());\r\n    }\r\n\r\n    return points_on_plane;\r\n  }\r\n\r\n  static matrix4_lerp(from,to,target, t)\r\n  {\r\n    for(let i=0; i< 16; i++)\r\n    {\r\n      target.elements[i] = THREE.Math.lerp(from.elements[i], to.elements[i], t);\r\n    }\r\n  }\r\n\r\n  static equals(x1, x2) {\r\n    return Math.abs(x1 - x2) < 0.000001\r\n  }\r\n}\r\n","import CameraManager from '/CameraManager';\r\nimport Input from '/Input';\r\nimport Sphere from '/primitives/Sphere';\r\nimport Arrow from '/primitives/Arrow';\r\nimport SceneManager from '/SceneManager';\r\nimport MathUtilities from '/utilities/MathUtilities';\r\nimport Screen from '/Screen';\r\n\r\nclass CameraUtilities\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.tmp_mat = new THREE.Matrix4();\r\n\t\tthis.tmp_vec = new THREE.Vector3(0,0,1);\r\n\t\tthis.tmp_vec2 = new THREE.Vector3(0,0,0);\r\n\t\tthis.plane = new THREE.Plane();\r\n\t\tthis.ray = new THREE.Ray();\r\n\r\n    this.tmp_size = new THREE.Vector3();\r\n    this.tmp_unproj = new THREE.Vector3();\r\n\t}\r\n\r\n  get_up_dir(camera) {\r\n    camera = camera || CameraManager.current;\r\n    this.tmp_vec.set(0, 1, 0);\r\n    this.tmp_vec.applyQuaternion(camera.quaternion);\r\n\r\n    return this.tmp_vec;\r\n  }\r\n\tget_forward_dir(camera)\r\n\t{\r\n    camera = camera || CameraManager.current;\r\n\t\tthis.tmp_vec.set(0,0,1);\r\n\t\tthis.tmp_vec.applyQuaternion(camera.quaternion);\r\n\r\n\t\treturn this.tmp_vec;\r\n\r\n\t}\r\n\tget_right_dir(camera)\r\n\t{\r\n    camera = camera || CameraManager.current;\r\n\t\tthis.tmp_vec.set(1,0,0);\r\n  \t\tthis.tmp_vec.applyQuaternion(camera.quaternion);\r\n  \t\treturn this.tmp_vec;\r\n\r\n\t}\r\n\r\n\tunproject_mouse_position(NDC, camera)\r\n  {\r\n    camera = camera || CameraManager.current;\r\n    let v_fov = (camera.fov/2) * Math.PI/180;\r\n    let h_fov = (2 * Math.atan(Math.tan(v_fov) * camera.aspect))/2;\r\n\r\n\r\n    let distV = Math.tan(v_fov) * camera.far;\r\n    let distH = Math.tan(h_fov) * camera.far;\r\n\r\n    this.tmp_vec.set(distH * NDC.x , distV * NDC.y, -camera.far).normalize();\r\n\r\n    return this.tmp_vec.applyQuaternion(camera.quaternion);\r\n  }\r\n\r\n  get_plane_intersection(plane_position, plane_normal, NDC, camera)\r\n  {\r\n    camera = camera || CameraManager.current;\r\n    NDC = NDC || Input.normalized_mouse_pos;\r\n\r\n\t\tthis.plane.setFromNormalAndCoplanarPoint(plane_normal || this.get_forward_dir(camera), plane_position);\r\n    if(camera.isPerspectiveCamera)\r\n    {\r\n      this.ray.set(camera.position, this.unproject_mouse_position(NDC, camera));\r\n    }\r\n    else\r\n    {\r\n      this.tmp_unproj.set(NDC.x, NDC.y, 1).unproject(camera);\r\n      this.ray.set(camera.position, this.tmp_unproj);\r\n    }\r\n\r\n    this.ray.intersectPlane(this.plane, this.tmp_vec2);\r\n    return this.tmp_vec2;\r\n  }\r\n\r\n\r\n\r\n\r\n  fit_points_on_camera(points, zoom_scale = 1)\r\n  {\r\n    let points_sphere = new THREE.Sphere().setFromPoints(points);\r\n    let world_space_center = points_sphere.center;\r\n    let camera_forward = this.get_forward_dir(CameraManager.current).clone();\r\n\r\n    let plane = new THREE.Plane().setFromNormalAndCoplanarPoint(camera_forward, world_space_center);\r\n\r\n\r\n\r\n    let points_on_plane = MathUtilities.project_points_on_plane(points, plane)\r\n\r\n    let projected_points_center = new THREE.Vector3();\r\n    let box =  new THREE.Box3().setFromPoints(points_on_plane);\r\n    box.getCenter(projected_points_center);\r\n\r\n\r\n    let up = new THREE.Vector3(0,1,0).applyQuaternion(CameraManager.current.quaternion)\r\n    let right = up.clone().cross(camera_forward).normalize();\r\n    let mat = new THREE.Matrix4().set(  right.x, up.x, camera_forward.x, world_space_center.x,\r\n                                        right.y, up.y, camera_forward.y, world_space_center.y,\r\n                                        right.z, up.z, camera_forward.z, world_space_center.z,\r\n                                              0,    0,                0,        1);\r\n\r\n    let inverse_mat = new THREE.Matrix4().getInverse(mat);\r\n    for(let i=0; i< points_on_plane.length; i++)\r\n    {\r\n      points_on_plane[i].applyMatrix4(inverse_mat);\r\n    }\r\n\r\n\r\n    let size = new THREE.Vector3();\r\n    box =  new THREE.Box3().setFromPoints(points_on_plane);\r\n    box.getSize(size);\r\n    size.multiplyScalar(zoom_scale);\r\n    let projected_center = new THREE.Vector3();\r\n    box.getCenter(projected_center);\r\n\r\n\r\n    return {\r\n      position: projected_points_center,\r\n      zoom: this.get_zoom_to_fit_rect(size.x/2, size.y/2)\r\n    }\r\n\r\n  }\r\n\r\n  get_zoom_to_fit_rect(width,height)\r\n  {\r\n    let v_fov = (CameraManager.current.fov/2) * Math.PI/180;\r\n    let h_fov = (2 * Math.atan(Math.tan(v_fov) * CameraManager.current.aspect))/2;\r\n\r\n    let distV = height / Math.tan(v_fov);\r\n    let distH = width / Math.tan(h_fov);\r\n\r\n    return Math.max(Math.abs(distH), Math.abs(distV));\r\n  }\r\n\r\n  get_zoom_to_fit_box(bb, camera)\r\n  {\r\n    if(camera.isOrthographicCamera)\r\n    {\r\n      bb.getSize(this.tmp_size);\r\n\r\n      let obj_x = this.tmp_size.x;\r\n      let obj_y = this.tmp_size.y;\r\n      let object_aspect = obj_x / obj_y;\r\n      if(Screen.aspect_ratio / object_aspect > 1)\r\n      {\r\n        return Screen.height/obj_y;\r\n      }\r\n      else\r\n      {\r\n        return Screen.width/obj_x;\r\n      }\r\n    }\r\n    else\r\n    {\r\n      // return this.fit_points_on_camera([bb.min, bb.max], 1).zoom;\r\n      let size = new THREE.Vector3();\r\n      bb.getSize(size);\r\n      return this.get_zoom_to_fit_rect(size.x, size.y);\r\n\r\n    }\r\n  }\r\n\r\n  get_html_screen_pos(object, camera)\r\n  {\r\n    object.getWorldPosition(this.tmp_vec);\r\n    this.tmp_vec.project(camera);\r\n\r\n    this.tmp_vec.x = (this.tmp_vec.x * 0.5 + 0.5) * (Screen.width);\r\n    this.tmp_vec.y = (1-(this.tmp_vec.y * 0.5 + 0.5)) * Screen.height;\r\n    return this.tmp_vec;\r\n  }\r\n\r\n  update_projection(camera)\r\n  {\r\n    camera.left   = -Screen.width/2;\r\n    camera.right  = Screen.width/2;\r\n    camera.top    = Screen.height/2;\r\n    camera.bottom = -Screen.height/2;\r\n    camera.aspect = Screen.aspect_ratio;\r\n    camera.updateProjectionMatrix(true);\r\n  }\r\n}\r\n\r\nconst camera_utilities = new CameraUtilities();\r\nmodule.exports = camera_utilities;\r\n","class Capabilities\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.max_anisotropy = 0;\r\n\t\tthis.vertex_texture_sampler_available = false;\r\n\t\tthis.fp_textures_available = false;\r\n\t}\r\n}\r\n\r\nconst capabilities = new Capabilities();\r\nmodule.exports = capabilities;\r\n","export default class EasingFunctions\r\n{\r\n\tconstructor(){}\r\n\r\n\tstatic ease_out_sine(x) {\r\n\t\treturn Math.sin(x * 3.14 / 2);\r\n\t}\r\n\r\n\tstatic ease_in_out_cubic(x) {\r\n\t\treturn x < 0.5 ?\r\n\t\t\t4 * x * x * x :\r\n\t\t\t1 - Math.pow(-2 * x + 2, 3) / 2;\r\n\t}\r\n\r\n\tstatic ease_out_cubic (x) {\r\n\t\treturn 1 - Math.pow(1 - x, 3);\r\n\t}\r\n\r\n\tstatic ease_in_out_quint (x) {\r\n\t\treturn x < 0.5 ?\r\n\t\t\t16 * x * x * x * x * x :\r\n\t\t\t1 - Math.pow(-2 * x + 2, 5) / 2;\r\n\t}\r\n\r\n\tstatic ease_out_quint (x) {\r\n\t\treturn 1 - Math.pow(1 - x, 5);\r\n\t}\r\n\r\n\tstatic ease_in_out_circ (x) {\r\n\t\treturn x < 0.5 ?\r\n\t\t\t(1 - Math.sqrt(1 - Math.pow(2 * x, 2))) / 2 :\r\n\t\t\t(Math.sqrt(1 - Math.pow(-2 * x + 2, 2)) + 1) / 2;\r\n\t}\r\n\r\n\tstatic ease_out_quad (x) {\r\n\t\treturn 1 - (1 - x) * (1 - x);\r\n\t}\r\n\r\n}","class EventManager\r\n{\r\n\r\n    constructor()\r\n    {\r\n        this.queue = {};\r\n\r\n        this.zoom_changed_evt           = \"zoom_changed\";\r\n        this.store_clickd_evt           = \"store_clicked\";\r\n        this.point_selected_evt         = \"point_selected\";\r\n        this.config_changed             = \"config_changed\";\r\n\r\n        this.path_substep_completed     = \"path_substep_completed\";\r\n        this.path_completed             = \"path_completed\";\r\n        this.go_to_store_requested_evt  = \"go_to_store_requested\";\r\n\r\n        this.resource_loaded_evt        = \"resource_loaded\";\r\n        this.service_clicked_evt        = \"service_clicked\";\r\n        this.unit_pos_updated_evt       = \"unit_position_updated\";\r\n\r\n        this.floor_changed_evt          = \"floor_changed\";\r\n\r\n        this.on_enter_floor_navigation  = \"on_enter_floor_navigation\";\r\n        this.on_exit_floor_navigation   = \"on_exit_floor_navigation\";\r\n\r\n        this.on_enter_floor_selection   = \"on_enter_floor_selection\";\r\n        this.on_exit_floor_selection    = \"on_exit_floor_selection\";\r\n\r\n        this.on_enter_outside_navigation  = \"on_enter_outside_navigation\";\r\n        this.on_exit_outside_navigation   = \"on_exit_outside_navigation\";\r\n\r\n        this.step_selected_evt = \"step_selected\";\r\n\r\n\r\n        \r\n    }\r\n\r\n    fire(event, payload)\r\n    {\r\n        let queue = this.queue[event];\r\n\r\n        if (queue === undefined) {\r\n            return;\r\n        }\r\n        let i = queue.length;\r\n        while (i--) {\r\n            queue[i](payload);\r\n        }\r\n\r\n    }\r\n\r\n    on(event, callback)\r\n    {\r\n        if (typeof this.queue[event] === 'undefined') \r\n        {\r\n            this.queue[event] = [];\r\n        }\r\n\r\n        this.queue[event].push(callback);\r\n    }\r\n\r\n    fire_zoom_changed(zoom)\r\n    {\r\n        this.fire(this.zoom_changed_evt, zoom);\r\n    }\r\n    fire_store_selected(store_id)\r\n    {\r\n        this.fire(this.store_clickd_evt, store_id);\r\n    }\r\n    fire_point_selected(hit_data)\r\n    {\r\n        this.fire(this.point_selected_evt, hit_data);\r\n    }\r\n    fire_config_changed()\r\n    {\r\n        this.fire(this.config_changed);\r\n    }\r\n    fire_path_substep_completed(step_number)\r\n    {\r\n        this.fire(this.path_substep_completed, step_number);\r\n    }\r\n    fire_path_completed()\r\n    {\r\n        this.fire(this.path_completed);\r\n    }\r\n    fire_step_selected(step_index)\r\n    {\r\n        this.fire(this.step_selected_evt, step_index);\r\n    }\r\n\r\n    fire_go_to_store_requested(store_id)\r\n    {\r\n        this.fire(this.go_to_store_requested_evt, store_id);\r\n    }\r\n\r\n    fire_resource_loaded(resource)\r\n    {\r\n        this.fire(this.resource_loaded_evt, resource);\r\n    }\r\n\r\n    fire_service_clicked(service)\r\n    {\r\n        this.fire(this.service_clicked_evt, service);\r\n    }\r\n    fire_unit_position_updated(unit_data)\r\n    {\r\n        this.fire(this.unit_pos_updated_evt, unit_data);\r\n    }\r\n\r\n    fire_floor_switched(floor_id)\r\n    {\r\n        this.fire(this.floor_changed_evt, floor_id);\r\n    }\r\n\r\n    fire_on_enter_floor_navigation(state)\r\n    {\r\n        this.fire(this.on_enter_floor_navigation, state);\r\n    }\r\n\r\n    fire_on_exit_floor_navigation(state)\r\n    {\r\n        this.fire(this.on_exit_floor_navigation, state);\r\n    }\r\n\r\n    fire_on_enter_floor_selection(state)\r\n    {\r\n        this.fire(this.on_enter_floor_selection,state);\r\n    }\r\n\r\n    fire_on_exit_floor_selection(state)\r\n    {\r\n        this.fire(this.on_exit_floor_selection,state);\r\n    }\r\n    \r\n    fire_on_enter_outside_navigation(state)\r\n    {\r\n        this.fire(this.on_enter_outside_navigation,state);\r\n    }\r\n\r\n    fire_on_exit_outside_navigation(state)\r\n    {\r\n        this.fire(this.on_exit_outside_navigation,state);\r\n    }\r\n\r\n\r\n}\r\n\r\nconst event_manager = new EventManager();\r\nmodule.exports = event_manager;","\r\nexport default class AxisHelper extends THREE.Object3D {\r\n  constructor(scale = 1.0) {\r\n    super();\r\n\r\n    const blueAxisMat = new THREE.LineBasicMaterial({ color: 0x4444ff, depthFunc: THREE.AlwaysDepth });\r\n    const blueAxisGeo = new THREE.Geometry();\r\n    blueAxisGeo.vertices.push(new THREE.Vector3(0, 0, 0));\r\n    blueAxisGeo.vertices.push(new THREE.Vector3(0, 0, 1000));\r\n    const blueAxisLine = new THREE.Line(blueAxisGeo, blueAxisMat);\r\n    blueAxisLine.renderOrder = 50000;\r\n\r\n    const greenAxisMat = new THREE.LineBasicMaterial({ color: 0x44ff44, depthFunc: THREE.AlwaysDepth });\r\n    const greenAxisGeo = new THREE.Geometry();\r\n    greenAxisGeo.vertices.push(new THREE.Vector3(0, 0, 0));\r\n    greenAxisGeo.vertices.push(new THREE.Vector3(0, 1000, 0));\r\n    const greenAxisLine = new THREE.Line(greenAxisGeo, greenAxisMat);\r\n    greenAxisLine.renderOrder = 50000;\r\n\r\n    const redAxisMat = new THREE.LineBasicMaterial({ linewidth: 100, color: 0xff4444, depthFunc: THREE.AlwaysDepth });\r\n    const redAxisGeo = new THREE.Geometry();\r\n    redAxisGeo.computeLineDistances();\r\n    redAxisGeo.vertices.push(new THREE.Vector3(0, 0, 0));\r\n    redAxisGeo.vertices.push(new THREE.Vector3(1000, 0, 0));\r\n    const redAxisLine = new THREE.Line(redAxisGeo, redAxisMat);\r\n    redAxisLine.renderOrder = 50000;\r\n    this.renderOrder = 100000;\r\n    this.add(blueAxisLine);\r\n    this.add(greenAxisLine);\r\n    this.add(redAxisLine);\r\n    this.scale.set(scale, scale, scale);\r\n \r\n  }\r\n\r\n  update() {\r\n  }\r\n\r\n  dispose() {\r\n\r\n  }\r\n}\r\n","module.exports=\"#define GLSLIFY 1\\nvarying vec2 vUv;\\n\\nvoid main()\\n{\\n  vec3 pos = position;\\n  mat4 MVP = projectionMatrix * modelViewMatrix;\\n\\n  gl_Position = MVP * vec4( pos, 1.0 );\\n  vUv = uv;\\n}\";","module.exports=\"#define GLSLIFY 1\\nuniform vec3 _Color;\\n\\nvoid main()\\n{\\n    gl_FragColor = vec4(_Color, 1.0);\\n}\";","export default class BaseRender\r\n{\r\n\tconstructor()\r\n\t{\r\n\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\ton_enter(context, renderer)\r\n\t{\r\n\r\n\t}\r\n\r\n\ton_exit(context, renderer)\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n\tresize()\r\n\t{\r\n\t\t\r\n\t}\r\n\r\n}\r\n"," \r\nexport default class RenderLayers {\r\n  constructor() {\r\n\r\n  }\r\n\r\n  static get opaque()            { return 0; }\r\n  static get transparent()       { return 1; }\r\n  static get outline()       \t\t { return 2; }\r\n  static get selectable()\t\t\t\t { return 3; }\r\n\r\n\r\n}\r\n\r\n\r\n\r\n","module.exports=\"#define GLSLIFY 1\\nuniform sampler2D _MainTex;\\nuniform sampler2D _Blur;\\nuniform vec2 _Screen;\\nvarying vec2 vUv;\\n\\nfloat aastep(float threshold, float value) {\\n  #ifdef GL_OES_standard_derivatives\\n    float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;\\n    return smoothstep(threshold-afwidth, threshold+afwidth, value);\\n  #else\\n    return step(threshold, value);\\n  #endif  \\n}\\n\\nvoid main()\\n{\\n\\tvec2 pixel_size = 1.0/_Screen;\\n\\n\\tvec4 color = texture2D( _MainTex, vUv);\\n\\tfloat mask = 1.0 - color.a;\\n\\n\\tfloat blur = texture2D( _Blur, vUv).a;\\n\\n  // gl_FragColor = vec4(mask,mask,mask,0.0);\\n  // gl_FragColor = color;\\n\\n\\tgl_FragColor = vec4(mix(color.rgb, mix(color.rgb, vec3(1.,0.,0.),aastep(0.076, blur)), mask), 1.0);\\n}\\n\\n\";","module.exports=\"#define GLSLIFY 1\\nuniform sampler2D _MainTex;\\nuniform vec2 _Resolution;\\nuniform vec2 _SampleDir;\\nvarying vec2 vUv;\\n\\nvoid main()\\n{\\n\\n\\tvec3 sum = vec3(0.,0.,0.);\\n\\tvec2 dir = (0.5/_Resolution) * _SampleDir;\\n\\tfloat _Distance = 2.0;\\n\\tsum += texture2D( _MainTex, vUv + dir * -4. * _Distance ).rgb * 0.0525;\\n\\tsum += texture2D( _MainTex, vUv + dir * -3. * _Distance ).rgb * 0.075;\\n\\tsum += texture2D( _MainTex, vUv + dir * -2. * _Distance ).rgb * 0.110;\\n\\tsum += texture2D( _MainTex, vUv + dir * -1. * _Distance ).rgb * 0.150;\\n\\tsum += texture2D( _MainTex, vUv + dir *  0. * _Distance ).rgb * 0.225;\\n\\tsum += texture2D( _MainTex, vUv + dir *  1. * _Distance ).rgb * 0.150;\\n\\tsum += texture2D( _MainTex, vUv + dir *  2. * _Distance ).rgb * 0.110;\\n\\tsum += texture2D( _MainTex, vUv + dir *  3. * _Distance ).rgb * 0.075;\\n\\tsum += texture2D( _MainTex, vUv + dir *  4. * _Distance ).rgb * 0.0525;\\n\\tgl_FragColor = vec4(sum, 1.0);\\n\\n}\\n\";","module.exports=\"#define GLSLIFY 1\\nuniform sampler2D _MainTex;\\n\\nvarying vec2 vUv;\\nvoid main()\\n{\\n\\tgl_FragColor = texture2D(_MainTex, vUv);\\n}\";","module.exports=\"#define GLSLIFY 1\\nvarying vec2 vUv;\\nvoid main()\\n{\\n\\tgl_Position = vec4(uv * 2.0 - 1.0, 1.0, 1.0);\\n\\tvUv = uv;\\n}\";","import Screen from '/Screen';\r\nimport RenderLayers from '/RenderLayers';\r\n\r\nimport compose_frag from '/shaders/box_blur/compose_frag';\r\nimport box_blur_frag from '/shaders/box_blur/box_blur_frag';\r\nimport copy_frag from '/shaders/copy/copy_frag';\r\nimport copy_vert from '/shaders/copy/copy_vert';\r\nimport background_frag from '/shaders/basic_color/basic_color_frag';\r\n\r\nexport default class OutlineRender\r\n{\r\n\r\n\tconstructor(webgl)\r\n\t{\r\n\t\tthis.main_rt \t\t\t\t= new THREE.WebGLRenderTarget(Screen.width, Screen.height);\r\n\t\tthis.rt1\t\t \t\t\t\t= new THREE.WebGLRenderTarget(Screen.width, Screen.height);\r\n\t\tthis.rt2\t\t \t\t\t\t= new THREE.WebGLRenderTarget(Screen.width, Screen.height);\r\n\r\n\r\n    this.compose_material \t\t= this.__get_compose_material();\r\n    this.copy_material \t\t\t\t= this.__get_copy_material();\r\n    this.box_blur_material \t\t= this.__get_box_blur_material();\r\n    this.background_material \t= this.__get_background_material();\r\n\r\n\t\tthis.copy_plane = new THREE.Mesh( new THREE.PlaneGeometry(1,1), this.copy_material );\r\n\t\tthis.copy_plane.frustumCulled = false;\r\n\t\tthis.copy_scene = new THREE.Scene();\r\n\t\tthis.copy_scene.add(this.copy_plane);\r\n\r\n\t}\r\n\r\n\tresize(w,h)\r\n\t{\r\n\t\tthis.main_rt.setSize(w,h);\r\n\t\tthis.rt1.setSize(w,h);\r\n\t\tthis.rt2.setSize(w,h);\r\n\t\tthis.box_blur_material.uniforms._Screen.value.set(w,h);\r\n\t\tthis.compose_material.uniforms._Screen.value.set(w,h);\r\n\t}\r\n\r\n\r\n\trender(webgl)\r\n\t{\r\n\t\twebgl.camera.updateMatrix();\r\n\t\twebgl.camera.updateMatrixWorld();\r\n\r\n\t\twebgl.camera.layers.enable(RenderLayers.opaque);\r\n\t\twebgl.camera.layers.enable(RenderLayers.transparent);\r\n\t\twebgl.camera.layers.disable(RenderLayers.outline);\r\n\r\n\t\t//render scene\r\n\t\twebgl._renderer.setClearColor(webgl.clear_color, 0);\r\n\t\twebgl._renderer.clearTarget(this.main_rt,true,true,true);\r\n\r\n\t\tthis.copy_scene.overrideMaterial = this.background_material;\r\n\t\tthis.background_material.uniforms._Color.value.set(webgl.clear_color.r, webgl.clear_color.g, webgl.clear_color.b, 0);\r\n\t\twebgl._renderer.render(this.copy_scene, webgl.camera, this.main_rt, false);\r\n\r\n\r\n\t\twebgl._renderer.render(webgl.scene, webgl.camera, this.main_rt, false);\r\n\r\n\r\n\r\n\r\n\t\t//horizontal blur\r\n\t\tthis.box_blur_material.uniforms._MainTex.value = this.main_rt.texture;\r\n\t\tthis.box_blur_material.uniforms._SampleDir.value.set(1,0);\r\n\r\n\t\tthis.copy_scene.overrideMaterial = this.box_blur_material;\r\n\t\twebgl._renderer.render(this.copy_scene, webgl.camera, this.rt1, false);\r\n\r\n\t\t//vertical blur\r\n\t\tthis.box_blur_material.uniforms._SampleDir.value.set(0,1);\r\n\t\tthis.box_blur_material.uniforms._MainTex.value = this.rt1.texture;\r\n\r\n\t\twebgl._renderer.render(this.copy_scene, webgl.camera, this.rt2, false);\r\n\r\n\r\n\t\t//compose\r\n\t\tthis.copy_scene.overrideMaterial = this.compose_material;\r\n\t\tthis.compose_material.uniforms._MainTex.value = this.main_rt.texture;\r\n\t\tthis.compose_material.uniforms._Blur.value = this.rt2.texture;\r\n\t\twebgl._renderer.render(this.copy_scene, webgl.camera, undefined, false);\r\n\t\tthis.copy_scene.overrideMaterial = undefined;\r\n\t}\r\n\r\n\t__get_copy_material()\r\n\t{\r\n\t\treturn new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _MainTex: \t\t\t{value : undefined}\r\n      },\r\n      vertexShader: copy_vert,\r\n      fragmentShader: copy_frag,\r\n      depthTest: false,\r\n      depthWrite: false\r\n    });\r\n\t}\r\n\r\n\t__get_box_blur_material()\r\n\t{\r\n \t\treturn new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _MainTex: \t\t\t{value : undefined},\r\n        _SampleDir: \t\t{value : new THREE.Vector2()},\r\n        _Screen: \t\t\t\t{value : new THREE.Vector2(Screen.width, Screen.height)}\r\n      },\r\n      vertexShader: copy_vert,\r\n      fragmentShader: box_blur_frag,\r\n      depthTest: false,\r\n      depthWrite: false\r\n    });\r\n\t}\r\n\r\n\t__get_compose_material()\r\n\t{\r\n\t\treturn new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _MainTex: \t\t\t{value : undefined},\r\n        _Blur: \t\t\t\t\t{value : undefined},\r\n        _Screen: \t\t\t\t{value : new THREE.Vector2(Screen.width, Screen.height)}\r\n      },\r\n      vertexShader: copy_vert,\r\n      fragmentShader: compose_frag,\r\n      depthTest: false,\r\n      depthWrite: false,\r\n      extensions: {\r\n      \tderivatives: true\r\n      }\r\n    });\r\n\t}\r\n\r\n\t__get_background_material()\r\n\t{\r\n\t\treturn new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _Color: \t\t\t\t{value : new THREE.Vector4(0,0,0,0)}\r\n      },\r\n      vertexShader: copy_vert,\r\n      fragmentShader: background_frag,\r\n      depthTest: true,\r\n      depthWrite: false\r\n\r\n    });\r\n\t}\r\n\r\n\ton_enter(webgl)\r\n\t{\r\n\t\twebgl._renderer.autoClear = false;\r\n\t}\r\n\r\n\ton_exit(webgl)\r\n\t{\r\n\t\twebgl._renderer.autoClear = true;\r\n\t}\r\n}\r\n","import Input from '/Input';\r\n\r\nclass UI\r\n{\r\n\r\n    constructor()\r\n    {\r\n        this.ui_elements = [];\r\n        this._tmp_normalized_pos = new THREE.Vector2();\r\n        this.scene = new THREE.Scene();\r\n        this.scene.autoUpdate = false;\r\n        this.scene.frustumCulled = false;\r\n    }\r\n\r\n    add_clickable_element(elem)\r\n    {\r\n        this.ui_elements.push(elem);\r\n        this.scene.add(elem.mesh);\r\n    }\r\n    remove_clickable_element(elem)\r\n    {\r\n        let index = this.ui_elements.indexOf(elem);\r\n        if (index > -1) {\r\n          this.ui_elements.splice(index, 1);\r\n        }\r\n\r\n        this.scene.remove(elem.mesh);\r\n    }\r\n\r\n    update()\r\n    {\r\n        this._tmp_normalized_pos.copy(Input.normalized_mouse_pos);\r\n        for(let i=0; i< this.ui_elements.length; i++)\r\n        {\r\n            this.ui_elements[i].update(this._tmp_normalized_pos)\r\n        }\r\n    }\r\n\r\n    render(renderer)\r\n    {\r\n        renderer.render_ui(this.scene);\r\n    }\r\n\r\n    clear()\r\n    {\r\n        this.current_clicked_element = undefined\r\n    }\r\n\r\n    resize()\r\n    {\r\n        for(let i=0; i< this.ui_elements.length; i++)\r\n        {\r\n            this.ui_elements[i].resize()\r\n        }\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\nconst ui = new UI();\r\nmodule.exports = ui;\r\n","import vert from '/shaders/copy/copy_vert';\r\nimport frag from '/shaders/copy/copy_frag';\r\n\r\nexport default class BlitMaterial extends THREE.ShaderMaterial\r\n{\r\n\tconstructor(frag_shader, vert_shader, defines)\r\n\t{\r\n\t\tsuper({\r\n\t\t\tuniforms: {\r\n\t\t\t\t_MainTex: {value: null},\r\n        _Resolution:{value: new THREE.Vector2(0,0)}\r\n\t\t\t},\r\n\t\t\tdefines: defines || {},\r\n\t\t\tvertexShader: vert_shader || vert,\r\n\t\t\tfragmentShader: frag_shader || frag,\r\n\t\t\tdepthWrite: false,\r\n      blending: THREE.NoBlending,\r\n      depthTest: false,\r\n      depthWrite: false,\r\n      depthFunc: THREE.AlwaysDepth\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","module.exports=\"#define GLSLIFY 1\\nuniform vec4 _DepthNormal;\\nvec2 EncodeFloatRG( float v )\\n{\\n    vec2 kEncodeMul = vec2(1.0, 255.0);\\n    float kEncodeBit = 1.0/255.0;\\n    vec2 enc = kEncodeMul * v;\\n    enc = fract (enc);\\n    enc.x -= enc.y * kEncodeBit;\\n    return enc;\\n}\\n\\nvec2 EncodeNormal (vec3 n)\\n{\\n    float scale = 1.7777;\\n    vec2 enc = n.xy / (n.z+1.0);\\n    enc /= scale;\\n    enc = enc*0.5+0.5;\\n    return enc;\\n}\\n\\nvoid main()\\n{\\n    gl_FragColor = vec4(EncodeFloatRG(_DepthNormal.x), EncodeNormal(normalize(_DepthNormal.yzw)));  \\n}\";","import BlitMaterial from '/materials/BlitMaterial';\r\nimport frag from '/shaders/clear/clear_depth_normal_frag';\r\n\r\nexport default class ClearDepthNormalMaterial extends BlitMaterial\r\n{\r\n\tconstructor(clear_depth, clear_normal)\r\n\t{\r\n\t\tsuper(frag);\r\n\t\tthis.uniforms._DepthNormal = {value: new THREE.Vector4(clear_depth, clear_normal.x, clear_normal.y, clear_normal.z)};\r\n\t}\r\n\r\n}\r\n","module.exports=\"#define GLSLIFY 1\\nvarying vec3 v_normal;\\nvarying vec3 v_pos;\\n\\nvoid main()\\n{\\n  vec3 pos = position;\\n  mat4 MVP = projectionMatrix * modelViewMatrix;\\n\\n  v_normal \\t= (modelViewMatrix * vec4(normal, 0.0)).xyz;\\n  v_pos \\t\\t= (modelViewMatrix * vec4( pos, 1.0 )).xyz;\\n\\n  gl_Position = MVP * vec4( pos, 1.0 );\\n}\";","module.exports=\"#define GLSLIFY 1\\nvarying vec3 v_normal;\\nvarying vec3 v_pos;\\n\\nuniform float _FarPlane;\\n\\nvec2 EncodeFloatRG( float v )\\n{\\n    vec2 kEncodeMul = vec2(1.0, 255.0);\\n    float kEncodeBit = 1.0/255.0;\\n    vec2 enc = kEncodeMul * v;\\n    enc = fract (enc);\\n    enc.x -= enc.y * kEncodeBit;\\n    return enc;\\n}\\n\\nvec2 EncodeNormal (vec3 n)\\n{\\n    float scale = 1.7777;\\n    vec2 enc = n.xy / (n.z+1.0);\\n    enc /= scale;\\n    enc = enc*0.5+0.5;\\n    return enc;\\n}\\n\\nvoid main()\\n{\\n\\tgl_FragColor = vec4(EncodeFloatRG(length(v_pos.z)/_FarPlane), EncodeNormal(normalize(v_normal)));\\t\\n}\\n\\n\";","import vert from '/shaders/depth_normals/depth_normals_vert';\r\nimport frag from '/shaders/depth_normals/depth_normals_frag';\r\n\r\nexport default class DepthNormalMaterial extends THREE.ShaderMaterial\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tsuper({\r\n      uniforms: {\r\n      \t_FarPlane: {value: 1}\r\n      },\r\n      vertexShader: vert,\r\n      fragmentShader: frag\r\n    });\r\n\t}\r\n\r\n\tset far_plane(value)\r\n\t{\r\n\t\tthis.uniforms._FarPlane.value = value;\r\n\t}\r\n\r\n}\r\n","import CameraManager from '/CameraManager';\r\nimport SceneManager from '/SceneManager';\r\nimport Screen from '/Screen';\r\n\r\nimport ClearDepthNormalMaterial from '/materials/ClearDepthNormalMaterial';\r\nimport DepthNormalMaterial from '/materials/DepthNormalMaterial';\r\n\r\nexport default class DepthAndNormalsRenderer\r\n{\r\n\tconstructor()\r\n\t{\r\n    this.RT = new THREE.WebGLRenderTarget(Screen.width, Screen.height);\r\n\r\n    this.clear_depth_normal_mat = new ClearDepthNormalMaterial(1, new THREE.Vector3(0,0,1));\r\n    this.depth_normal_material = new DepthNormalMaterial();\r\n\t}\r\n\r\n\r\n\trender(graphics)\r\n\t{\r\n\t\tthis.__resize_RT_if_necessary();\r\n\r\n\r\n    graphics.clear(this.RT, undefined, true,true)\r\n\r\n    graphics.blit_clear_with_material(this.RT, this.clear_depth_normal_mat);\r\n\r\n    this.depth_normal_material.far_plane = CameraManager.current.far;\r\n\r\n    graphics.render(undefined, undefined, this.RT, this.depth_normal_material);\r\n\r\n\t}\r\n\r\n  __resize_RT_if_necessary()\r\n  {\r\n    if(this.RT.width !== Screen.width || this.RT.height !== Screen.height)\r\n    {\r\n      this.RT.setSize(Screen.width, Screen.height);\r\n    }\r\n  }\r\n\r\n\tget render_target()\r\n\t{\r\n\t\treturn this.RT;\r\n\t}\r\n\r\n}\r\n","import BlitMaterial from '/materials/BlitMaterial';\r\n\r\nexport default class Blitter\r\n{\r\n\r\n  constructor(renderer)\r\n  {\r\n      this.renderer = renderer;\r\n      this._blit_scene = new THREE.Scene();\r\n      this._blit_material = new BlitMaterial();\r\n      this._blit_quad = new THREE.Mesh(\r\n        new THREE.PlaneBufferGeometry( 1, 1 ),this._blit_material );\r\n      this._blit_scene.add( this._blit_quad );\r\n      this._blit_camera = new THREE.OrthographicCamera( -1, 1, 1, -1, -10000, 10000 );\r\n\r\n  }\r\n\r\n\r\n  blit(src, dst)\r\n  {\r\n    this._blit_quad.material = this._blit_material;\r\n    this._blit_quad.material.uniforms._MainTex.value = src.texture;\r\n    this._blit_quad.material.uniforms._Resolution.value.set(src.width, src.height);\r\n\r\n    this.renderer.setRenderTarget(dst === undefined? null : dst);\r\n\r\n    this.renderer.render( this._blit_scene,\r\n                          this._blit_camera);\r\n  }\r\n\r\n  blit_with_material(src, dst, mat)\r\n  {\r\n    this._blit_quad.material = mat;\r\n    this._blit_quad.material.uniforms._MainTex.value = src.texture;\r\n    this._blit_quad.material.uniforms._Resolution.value.set(src.width, src.height);\r\n\r\n    this.renderer.setRenderTarget(dst === undefined? null : dst);\r\n\r\n    this.renderer.render( this._blit_scene,\r\n                          this._blit_camera );\r\n  }\r\n\r\n  blit_clear_with_material(dst_RT, mat)\r\n  {\r\n    this._blit_quad.material = mat;\r\n\r\n    this.renderer.setRenderTarget(dst_RT === undefined? null : dst_RT);\r\n\r\n    this.renderer.render( this._blit_scene, this._blit_camera);\r\n  }\r\n\r\n}\r\n","import Configuration from           '/Configuration';\r\nimport BaseRender from   '/render_mode/BaseRender';\r\nimport OutlineRender from           '/render_mode/OutlineRender';\r\nimport Screen from '/Screen';\r\nimport CameraManager from '/CameraManager';\r\nimport SceneManager from '/SceneManager';\r\nimport UI from '/UI';\r\nimport Capabilities from '/Capabilities';\r\nimport DepthAndNormalsRenderer from '/render_utilities/DepthAndNormalsRenderer';\r\nimport Blitter from '/render_utilities/Blitter';\r\n\r\nclass Graphics {\r\n\r\n\r\n  constructor() {\r\n    this._renderer = undefined;\r\n    this.blitter = undefined;\r\n    this.canvas = undefined;\r\n    this.no_render = undefined;\r\n    this.current_render_mode = undefined;\r\n    this.generateDepthNormalTexture = false;\r\n    this.depth_and_normals_renderer = undefined;\r\n  }\r\n\r\n  init(canvas) {\r\n    this._renderer = new THREE.WebGLRenderer({\r\n      antialias: true,\r\n      preserveDrawingBuffer: true,\r\n      alpha: true,\r\n      canvas: canvas\r\n    });\r\n\r\n    this._renderer.autoClear = false;\r\n\r\n    this._renderer.setPixelRatio(window.devicePixelRatio);\r\n\r\n\t\tthis._renderer.extensions.get( 'ANGLE_instanced_arrays' )\r\n\r\n    this.blitter = new Blitter(this._renderer);\r\n\r\n    this.canvas = this._renderer.domElement;\r\n\r\n    this.no_render = new BaseRender();\r\n\r\n    this.current_render_mode = this.no_render;\r\n\r\n    Capabilities.max_anisotropy = this._renderer.capabilities.getMaxAnisotropy();\r\n    Capabilities.vertex_texture_sampler_available = this._renderer.capabilities.maxVertexTextures > 0;\r\n    Capabilities.fp_textures_available = this._renderer.capabilities.floatVertexTextures;\r\n\r\n    this.generateDepthNormalTexture = false;\r\n\r\n    this.depth_and_normals_renderer = new DepthAndNormalsRenderer();\r\n\r\n  }\r\n\r\n  get dom_element()\r\n  {\r\n    return this._renderer.domElement;\r\n  }\r\n\r\n  get depth_normals_RT()\r\n  {\r\n    return this.depth_and_normals_renderer.render_target;\r\n  }\r\n\r\n\r\n  set_state(new_state)\r\n  {\r\n    console.log(\"VIEWAPI - map render mode switch to: \" + new_state.constructor.name);\r\n\r\n    this.current_render_mode.on_exit(this, this._renderer);\r\n    this.current_render_mode = new_state;\r\n    this.current_render_mode.on_enter(this, this._renderer);\r\n  }\r\n\r\n  update() {\r\n    if(this.generateDepthNormalTexture)\r\n    {\r\n      this.depth_and_normals_renderer.render(this);\r\n    }\r\n\r\n    if(CameraManager.current)\r\n    {\r\n      CameraManager.current.aspect = Screen.aspect_ratio;\r\n\r\n      CameraManager.current.updateProjectionMatrix();\r\n\r\n      CameraManager.current.updateMatrix();\r\n      CameraManager.current.updateMatrixWorld(true);\r\n      this.current_render_mode.render();\r\n    }\r\n  }\r\n\r\n\r\n\r\n  render(scene, camera, RT, override_mat)\r\n  {\r\n    this.__apply_override_material(scene, override_mat);\r\n\r\n    this._renderer.setRenderTarget(RT === undefined? null : RT);\r\n    this._renderer.render(scene  || SceneManager.current,\r\n                          camera || CameraManager.current);\r\n\r\n    this.__apply_override_material(scene, undefined);\r\n\r\n\r\n  }\r\n\r\n  __apply_override_material(scene, mat)\r\n  {\r\n    if(scene)\r\n      scene.overrideMaterial = mat;\r\n    else\r\n      SceneManager.current.overrideMaterial = mat;\r\n  }\r\n\r\n  readback_RT(RT, buffer)\r\n  {\r\n    this._renderer.readRenderTargetPixels( RT, 0, 0, RT.width, RT.height, buffer);\r\n  }\r\n\r\n  clear(RT, camera, clear_depth, clear_stencil)\r\n  {\r\n    this._renderer.setRenderTarget(RT === undefined? null : RT);\r\n\r\n    if(camera)\r\n    {\r\n      this._renderer.setClearColor(camera.clear_color, camera.clear_alpha);\r\n    }\r\n\r\n    this._renderer.clear( camera?         true : false, // clear color\r\n                          clear_depth?    true : false,\r\n                          clear_stencil?  true : false);\r\n  }\r\n\r\n  render_ui(scene)\r\n  {\r\n    this._renderer.render(scene, CameraManager.current)\r\n  }\r\n\r\n\r\n\r\n  on_resize() {\r\n\r\n    let width  = this.canvas.offsetWidth;\r\n    let height = this.canvas.offsetHeight;\r\n    Screen.update_size(width, height);\r\n    Screen.update_native_size()\r\n\r\n    this._renderer.setSize(width,height, false);\r\n\r\n    UI.resize();\r\n    this.current_render_mode.resize(width,height);\r\n\r\n  }\r\n\r\n\r\n  blit(src_RT, dst_RT, mat)\r\n  {\r\n    if(mat)\r\n      this.blitter.blit_with_material(src_RT, dst_RT, mat);\r\n    else\r\n      this.blitter.blit(src_RT, dst_RT);\r\n  }\r\n\r\n  blit_clear_with_material(dst_RT, mat)\r\n  {\r\n    this.blitter.blit_clear_with_material(dst_RT, mat);\r\n  }\r\n\r\n\r\n  take_screenshot(blob_callback)\r\n  {\r\n\r\n    const ctx = this;\r\n\r\n\r\n    let old_width = Screen.width;\r\n    let old_height = Screen.height;\r\n\r\n    let new_width = 4096;\r\n    let new_height = 4096;\r\n\r\n    let tile_width = 1024;\r\n    let tile_height = 1024;\r\n\r\n    let divisions_x = parseInt(Math.ceil(new_width / tile_width));\r\n    let divisions_y = parseInt(Math.ceil(new_height / tile_height));\r\n\r\n    Screen.update_size(tile_width, tile_height);\r\n\r\n    this._renderer.setPixelRatio(1);\r\n\r\n    this._renderer.setSize(tile_width ,tile_height, false);\r\n\r\n    this.ctx_2D.canvas.width  = new_width;\r\n    this.ctx_2D.canvas.height = new_height;\r\n\r\n    CameraManager.current.aspect = Screen.aspect_ratio;\r\n    CameraManager.current.updateMatrix();\r\n    CameraManager.current.updateMatrixWorld(true);\r\n\r\n    for(let x = 0; x < divisions_x; x++)\r\n    {\r\n      for(let y = 0; y < divisions_y; y++)\r\n      {\r\n\r\n        CameraManager.current.setViewOffset( new_width,             new_height,\r\n                                             Screen.width*x,         Screen.height*y,\r\n                                             Screen.width,            Screen.height);\r\n        this.current_render_mode.render();\r\n\r\n        this.ctx_2D.drawImage(this._renderer.domElement, Screen.width*x, Screen.height*y);\r\n      }\r\n    }\r\n\r\n    // transform the result canvas into a blob\r\n    // from them the callback turns into a ULR and download it\r\n    this.ctx_2D.canvas.toBlob(blob_callback,\"image/png;base64;\");\r\n\r\n    CameraManager.current.clearViewOffset();\r\n    Screen.update_size(old_width,old_height);\r\n    this._renderer.setPixelRatio(window.devicePixelRatio);\r\n    this._renderer.setSize(old_width,old_height, false);\r\n\r\n    CameraManager.current.aspect = Screen.aspect_ratio;\r\n    CameraManager.current.updateMatrix();\r\n    CameraManager.current.updateMatrixWorld(true);\r\n\r\n  }\r\n\r\n  download_screenshot (blob) {\r\n    console.log(\"el blob\", blob);\r\n    let link = document.createElement('a');\r\n    link.download = \"Snapshot.png\";\r\n\r\n    link.href = URL.createObjectURL(blob);\r\n    link.click()\r\n\r\n    link.onclick = function() {\r\n      requestAnimationFrame(function() {\r\n        URL.revokeObjectURL(a.href);\r\n      });\r\n      a.removeAttribute('href')\r\n    };\r\n\r\n  }\r\n\r\n}\r\n\r\nconst graphics = new Graphics();\r\nmodule.exports = graphics;\r\n\r\n","import Mesh from '/Mesh';\r\n\r\nexport default class Cube extends Mesh\r\n{\r\n\tconstructor(size, segments, color)\r\n\t{\r\n\t\tsize \t\t\t= size || new THREE.Vector3(1,1,1);\r\n\t\tsegments \t= segments || new THREE.Vector3(1,1,1);\r\n    color \t\t= color || 0xff0000;\r\n    let geometry = new THREE.BoxGeometry( size.x, size.y, size.z, segments.x, segments.y, segments.z);\r\n    let material = new THREE.MeshBasicMaterial( {color: color} );\r\n\t\tsuper(geometry, material);\r\n\t}\r\n}\r\n","import AxisHelper from '/components/AxisHelper';\r\nimport basic_color_vert from '/shaders/basic_color/basic_color_vert';\r\nimport basic_color_frag from '/shaders/basic_color/basic_color_frag';\r\nimport SceneManager from '/SceneManager';\r\nimport Graphics from '/Graphics';\r\nimport Cube from '/primitives/Cube';\r\nimport Sphere from '/primitives/Sphere';\r\n\r\nclass Debug {\r\n  constructor() {\r\n    this.Vector3_one = new THREE.Vector3(1,1,1);\r\n    this.Vector3_zero = new THREE.Vector3(0,0,0);\r\n    this.canvas_renderer = undefined;\r\n\r\n    this.rt_debug = undefined;\r\n  }\r\n\r\n  init(webgl)\r\n  {\r\n    this.webgl = webgl;\r\n\r\n    this.ctx = undefined;\r\n\r\n    // var cln = webgl.dom.cloneNode(false);\r\n    // cln.id = \"canvas_debug\";\r\n    // $(cln).css(\"position\", \"absolute\");\r\n    // webgl.dom.parentElement.insertBefore(cln, webgl.dom);\r\n    // this.ctx = cln.getContext('2d');\r\n\r\n    // this.ctx.clearRect(0, 0, cln.width, cln.height);\r\n    // this.ctx.fillStyle =  \"rgba(255, 0, 0, 1)\";\r\n\r\n  }\r\n\r\n  draw_axis()\r\n  {\r\n    let axis = new AxisHelper();\r\n    SceneManager.current.add(axis);\r\n    return axis;\r\n  }\r\n\r\n  set_debug_RT(RT)\r\n  {\r\n    this.rt_debug = RT;\r\n  }\r\n\r\n  draw_rectangle(position_2d, width, height, color)\r\n  {\r\n    width  = width || 100;\r\n    height = height || 100;\r\n    this.ctx.fillStyle =  color || \"rgba(255, 0, 0, 1)\";\r\n    this.ctx.fillRect(position_2d.x - width/2,\r\n                      (this.ctx.canvas.height - position_2d.y) - height/2,width,height);\r\n\r\n  }\r\n\r\n  clear()\r\n  {\r\n    if(this.ctx)\r\n      this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);\r\n  }\r\n\r\n  draw_line_2D(from, to, color)\r\n  {\r\n    this.ctx.strokeStyle =  color ||\"rgba(255, 0, 0, 1)\";\r\n    this.ctx.beginPath();\r\n    this.ctx.moveTo(from.x, from.y);\r\n    this.ctx.lineTo(to.x, to.y);\r\n    this.ctx.closePath();\r\n    this.ctx.stroke();\r\n  }\r\n\r\n  draw_line(from, to, color)\r\n  {\r\n    color = color || 0xff0000;\r\n    let mat = new THREE.LineBasicMaterial({ color: color });\r\n    let geo = new THREE.Geometry();\r\n    geo.vertices.push(from);\r\n    geo.vertices.push(to);\r\n    let line = new THREE.Line(geo, mat);\r\n    SceneManager.current.add(line);\r\n    return line;\r\n  }\r\n  draw_cube(pos, size, color)\r\n  {\r\n    size = size || 1;\r\n    color = color || 0xff0000;\r\n    pos = pos || new THREE.Vector3();\r\n\r\n    var cube = new Cube(new THREE.Vector3(size, size, size), undefined, color );\r\n    cube.position.copy(pos);\r\n    SceneManager.current.add( cube );\r\n    return cube;\r\n  }\r\n  draw_oriented_cube(from, to, height = 1, color = \"#FF0000\", depth = 0.1)\r\n  {\r\n  \tlet size = from.distanceTo(to);\r\n    let cube = new Cube(new THREE.Vector3(depth, height, size), undefined, color );\r\n\r\n  \tlet center = to.clone().sub(from).multiplyScalar(0.5);\r\n\t\tlet forward_dir = center.clone().normalize();\r\n\t\tcenter.add(from);\r\n\r\n\t\tcube.position.copy(center);\r\n\r\n\r\n\t\tlet up = new THREE.Vector3(0,1,0);\r\n  \tlet forward = forward_dir.clone();\r\n  \tlet right = forward.clone().cross(up);\r\n\r\n  \t// cube.quaternion.setFromRotationMatrix(new THREE.Matrix4().makeBasis(right,up,forward));\r\n  \tcube.quaternion.setFromUnitVectors(new THREE.Vector3(0,0,-1), forward_dir);\r\n\r\n    SceneManager.current.add( cube );\r\n    return cube;\r\n  }\r\n  draw_plane(width, height, color)\r\n  {\r\n    var geometry = new THREE.PlaneGeometry( width, height );\r\n    let material = new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _Color: {value : new THREE.Vector4(0,1,0, 0.2)},\r\n      },\r\n      vertexShader: basic_color_vert,\r\n      fragmentShader: basic_color_frag,\r\n      transparent: true,\r\n      depthWrite: false\r\n    });\r\n\r\n    var plane = new THREE.Mesh( geometry, material );\r\n    plane.renderOrder = -10000\r\n    SceneManager.current.add(plane);\r\n    return plane;\r\n  }\r\n  draw_empty_cube(pos, size,color)\r\n  {\r\n    size = size || 1;\r\n    color = color || 0xff0000;\r\n\r\n    let box = new THREE.Box3().setFromCenterAndSize(new THREE.Vector3(), new THREE.Vector3(size, size, size));\r\n    let helper = new THREE.Box3Helper( box, color );\r\n    helper.position.copy(pos || new THREE.Vector3());\r\n    return helper;\r\n  }\r\n  draw_sphere(pos, size, color)\r\n  {\r\n    size = size || 1;\r\n    color = color || 0xff0000;\r\n    pos = pos || new THREE.Vector3();\r\n\r\n    var sphere = new Sphere(size, color );\r\n    sphere.position.copy(pos);\r\n    SceneManager.current.add( sphere );\r\n    return sphere;\r\n  }\r\n  draw_sphere_helper(sphere, color)\r\n  {\r\n    color = color || 0xff0000;\r\n    var geometry = new THREE.SphereGeometry( sphere.radius, 32, 32 );\r\n    var material = new THREE.MeshBasicMaterial( {color: color, side: THREE.DoubleSide} );\r\n    var sphere = new THREE.Mesh( geometry, material );\r\n    SceneManager.current.add(sphere);\r\n  }\r\n\r\n  draw_math_sphere(sphere)\r\n  {\r\n    var geometry = new THREE.SphereGeometry( sphere.radius, 32, 32 );\r\n    let material = new THREE.ShaderMaterial({\r\n      uniforms: {\r\n        _Color: {value : new THREE.Vector4(1,0,0, 0.2)},\r\n      },\r\n      vertexShader: basic_color_vert,\r\n      fragmentShader: basic_color_frag,\r\n      transparent: true\r\n    });\r\n    // var material = new THREE.MeshBasicMaterial( {color: 0xff0000, transparent = true} );\r\n    var sphere1 = new THREE.Mesh( geometry, material );\r\n    sphere1.position.copy(sphere.center);\r\n    SceneManager.current.add(sphere1)\r\n  }\r\n\r\n  draw_bounding_box(bb)\r\n  {\r\n    var helper = new THREE.Box3Helper( bb, 0xffff00 );\r\n    SceneManager.current.add( helper );\r\n  }\r\n\r\n  draw_curve(curve, options)\r\n  {\r\n    let offset = new THREE.Vector3(0,0, 0);\r\n    if(options)\r\n      offset.y = options.offset || 0;\r\n\r\n    for(let i=0; i< curve.length-1; i++)\r\n    {\r\n      this.draw_line(curve[i].clone().add(offset), curve[i+1].clone().add(offset));\r\n    }\r\n  }\r\n\r\n}\r\n\r\nconst DEBUG = new Debug();\r\nmodule.exports = DEBUG;\r\n","import CameraManager from '/CameraManager';\r\nimport SceneManager from '/SceneManager';\r\nimport Screen from '/Screen';\r\nimport BaseRender from '/render_mode/BaseRender';\r\nimport Graphics from '/Graphics';\r\n\r\nexport default class NormalRender extends BaseRender\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tsuper();\r\n\t}\r\n\r\n\r\n\trender()\r\n\t{\r\n\t\tGraphics.clear(undefined, CameraManager.current, true, true);\r\n\r\n\t\tGraphics.render(SceneManager.current, CameraManager.current);\r\n\t}\r\n\r\n}\r\n","export default class ObjectUtilities\r\n{\r\n\tconstructor(){}\r\n\r\n  // Changes XML to JSON\r\n  static xml_to_json(xml) {\r\n\r\n    // Create the return object\r\n    var obj = {};\r\n\r\n    if (xml.nodeType == 1) { // element\r\n      // do attributes\r\n      if (xml.attributes.length > 0) {\r\n        obj[\"@attributes\"] = {};\r\n        for (var j = 0; j < xml.attributes.length; j++) {\r\n          var attribute = xml.attributes.item(j);\r\n          obj[\"@attributes\"][attribute.nodeName] = attribute.nodeValue;\r\n        }\r\n      }\r\n    } else if (xml.nodeType == 3) { // text\r\n      obj = xml.nodeValue;\r\n    }\r\n\r\n    // do children\r\n    if (xml.hasChildNodes()) {\r\n      for (var i = 0; i < xml.childNodes.length; i++) {\r\n        var item = xml.childNodes.item(i);\r\n        var nodeName = item.nodeName;\r\n        if (typeof (obj[nodeName]) == \"undefined\") {\r\n          obj[nodeName] = this.xml_to_json(item);\r\n        } else {\r\n          if (typeof (obj[nodeName].push) == \"undefined\") {\r\n            var old = obj[nodeName];\r\n            obj[nodeName] = [];\r\n            obj[nodeName].push(old);\r\n          }\r\n          obj[nodeName].push(this.xml_to_json(item));\r\n        }\r\n      }\r\n    }\r\n    return obj;\r\n  };\r\n\r\n}\r\n\r\n","export default class PerspectiveCamera extends THREE.PerspectiveCamera\r\n{\r\n\tconstructor(fov, aspect, near, far)\r\n\t{\r\n\t\tsuper(fov, aspect, near, far);\r\n\r\n\t\tthis.clear_color = new THREE.Color(\"#000000\");\r\n\t\tthis.clear_alpha = 1;\r\n\t}\r\n}","export default class GeometryBatch\r\n{\r\n\tconstructor(geometry, batch_width)\r\n\t{\r\n\t\tthis.geometry = geometry;\r\n\r\n\t\tthis.material = undefined;\r\n\t\tthis.uniforms = {};\r\n\t\tthis.batch_width = batch_width;\r\n\r\n\t\tthis.data_textures = [];\r\n\r\n\t\tthis.object_names = undefined;\r\n\r\n\r\n\t\tthis.zero_offset = new THREE.Vector2();\r\n\t\tthis.write_offset = new THREE.Vector2();\r\n\r\n\t\tthis.uniform_dirty_count = 0;\r\n\r\n\t\tthis.tmp_uploaded_data_count = 0;\r\n\r\n\t}\r\n\r\n\tinit(object_names, vert_shader, frag_shader)\r\n\t{\r\n\t\tthis.material = new THREE.ShaderMaterial({\r\n\t\t\tuniforms: this.uniforms,\r\n\t\t\tvertexShader: vert_shader,\r\n\t\t\tfragmentShader: frag_shader\r\n\t\t});\r\n\t\tthis.object_names = object_names;\r\n\r\n\t}\r\n\r\n\tadd_global_uniform(name, data)\r\n\t{\r\n\t\tthis.uniforms[name] = {value: data};\r\n\t\tthis.material.needsUpdate = true;\r\n\t}\r\n\tset_global_uniform(name, data)\r\n\t{\r\n\t\tthis.uniforms[name].value = data;\r\n\t}\r\n\r\n\tadd_object_uniform_v3(uniform_name, default_value_v3)\r\n\t{\r\n\t\tlet src_tex \t\t= this.__create_rgb_texture(this.batch_width);\r\n\t\tlet dst_tex \t\t= this.__create_rgb_texture(this.batch_width);\r\n\t\tlet one_pixel_tex = this.__create_rgb_texture(1);\r\n\r\n\r\n\t\tlet new_data_tex = this.__add_data_texture(uniform_name, src_tex, dst_tex, one_pixel_tex);\r\n\r\n\t\tif(default_value_v3)\r\n\t\t\tthis.__flood_data_texture_rgb(new_data_tex, default_value_v3);\r\n\t\r\n\t}\r\n\r\n\tadd_object_uniform_v4(uniform_name, default_value_v4)\r\n\t{\r\n\t\tlet src_tex \t\t= this.__create_rgba_texture(this.batch_width);\r\n\t\tlet dst_tex \t\t= this.__create_rgba_texture(this.batch_width);\r\n\t\tlet one_pixel_tex = this.__create_rgba_texture(1);\r\n\r\n\r\n\t\tlet new_data_tex = this.__add_data_texture(uniform_name, src_tex, dst_tex, one_pixel_tex);\r\n\r\n\t\tif(default_value_v4)\r\n\t\t\tthis.__flood_data_texture_rgba(new_data_tex, default_value_v4);\r\n\t\r\n\t}\r\n\r\n\tadd_object_uniform_v4_float(uniform_name, default_value_v4)\r\n\t{\r\n\t\tlet src_tex \t\t= this.__create_rgba_float_texture(this.batch_width);\r\n\t\tlet dst_tex \t\t= this.__create_rgba_float_texture(this.batch_width);\r\n\t\tlet one_pixel_tex = this.__create_rgba_float_texture(1);\r\n\r\n\r\n\t\tlet new_data_tex = this.__add_data_texture(uniform_name, src_tex, dst_tex, one_pixel_tex);\r\n\r\n\t\tif(default_value_v4)\r\n\t\t\tthis.__flood_data_texture_rgba(new_data_tex, default_value_v4);\r\n\t\r\n\t}\r\n\r\n\tset_object_uniform_v3(object_name, uniform_name, vector3, use_r, use_g, use_b)\r\n\t{\r\n\t\tlet obj_index = this.__get_object_index(object_name);\r\n\t\tlet data_texture = this.__get_data_texture(uniform_name);\r\n\r\n\t\tthis.__set_pixel_rgb(data_texture.src, obj_index, vector3, use_r, use_g, use_b);\r\n\t\tthis.__set_pixel_rgb(data_texture.one_pixel, 0\t, vector3, use_r, use_g, use_b);\r\n\r\n\t\tdata_texture.last_accessed_index = obj_index;\r\n\r\n\t\tdata_texture.dirty_count++; \r\n\t}\r\n\r\n\tset_object_uniform_v4(object_name, uniform_name, vector4, use_r, use_g, use_b, use_a)\r\n\t{\r\n\t\tlet obj_index = this.__get_object_index(object_name);\r\n\t\tlet data_texture = this.__get_data_texture(uniform_name);\r\n\r\n\t\tthis.__set_pixel_rgba(data_texture.src, obj_index, vector4, use_r, use_g, use_b, use_a);\r\n\t\tthis.__set_pixel_rgba(data_texture.one_pixel, 0, vector4, use_r, use_g, use_b, use_a);\r\n\t\tdata_texture.last_accessed_index = obj_index;\r\n\r\n\t\tdata_texture.dirty_count++; \r\n\t}\r\n\r\n\r\n\tupload_texture_data(renderer, upload_budget)\r\n\t{\r\n\t\tfor(let i=0; i< this.data_textures.length; i++)\r\n\t\t{\r\n\t\t\tif(upload_budget > 0 && this.data_textures[i].dirty_count > 0)\r\n\t\t\t{\r\n\t\t\t\tif(this.data_textures[i].dirty_count === 1)\r\n\t\t\t\t\tthis.__partial_texture_data_upload(renderer, this.data_textures[i]);\r\n\t\t\t\tif(this.data_textures[i].dirty_count > 1)\r\n\t\t\t\t\tthis.__full_texture_data_upload(renderer, this.data_textures[i]);\r\n\r\n\t\t\t\tthis.data_textures[i].dirty_count = 0;\r\n\r\n\t\t\t\tupload_budget--;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tget_uniform_dirty_count()\r\n\t{\r\n\t\tthis.uniform_dirty_count = 0;\r\n\t\tfor(let i=0; i< this.data_textures.length; i++)\r\n\t\t{\r\n\t\t\tif(this.data_textures[i].dirty_count > 0)\r\n\t\t\t\tthis.uniform_dirty_count++;\r\n\t\t}\r\n\t\treturn this.uniform_dirty_count;\r\n\t}\r\n\r\n\r\n\t__full_texture_data_upload(renderer, texture_data)\r\n\t{\r\n\t\t// console.log(\"full texture update of\"+ texture_data.name);\r\n\t\ttexture_data.dst.needsUpdate = true;\r\n\t\trenderer.copyTextureToTexture(\r\n\t\t\t\t\tthis.zero_offset, \r\n\t\t\t\t\ttexture_data.src, \r\n\t\t\t\t\ttexture_data.dst\r\n\t\t\t);\r\n\t}\r\n\t__partial_texture_data_upload(renderer, texture_data)\r\n\t{\r\n\t\t// console.log(\"partial texture update\"+ texture_data.name);\r\n\t\tlet index = texture_data.last_accessed_index;\r\n\t\tif(index === -1)\r\n\t\t\treturn;\r\n\t\t\r\n  \tthis.write_offset.y = Math.floor(index/this.batch_width);\r\n  \tthis.write_offset.x = index - this.batch_width*this.write_offset.y;\r\n\t\trenderer.copyTextureToTexture(\r\n\t\t\tthis.write_offset, \r\n\t\t\ttexture_data.one_pixel, \r\n\t\t\ttexture_data.dst\r\n\t\t);\r\n\t}\r\n\r\n\tget_mesh()\r\n\t{\r\n\t\treturn new THREE.Mesh(this.geometry, this.material);\r\n\t}\r\n\r\n\t__set_pixel_rgb(data_texture, index, vector3, use_r, use_g, use_b)\r\n\t{\r\n\t\tif(use_r)\r\n\t\t\tdata_texture.image.data[index*3+0] = vector3.x;\t    \r\n\t\tif(use_g)\r\n\t\t\tdata_texture.image.data[index*3+1] = vector3.y;\t    \r\n\t\tif(use_b)\r\n\t\t\tdata_texture.image.data[index*3+2] = vector3.z;\t\r\n\t}\r\n\t__set_pixel_rgba(data_texture, index, vector4, use_r, use_g, use_b, use_a)\r\n\t{\r\n\t\tif(use_r)\r\n\t\t\tdata_texture.image.data[index*4+0] = vector4.x;\t    \r\n\t\tif(use_g)\r\n\t\t\tdata_texture.image.data[index*4+1] = vector4.y;\t    \r\n\t\tif(use_b)\r\n\t\t\tdata_texture.image.data[index*4+2] = vector4.z;\t\r\n\t\tif(use_a)\r\n\t\t\tdata_texture.image.data[index*4+3] = vector4.w;\r\n\t}\r\n\r\n\t__flood_data_texture_rgb(data_texture, v3)\r\n\t{\r\n\t\tfor(let i=0; i< this.batch_width * this.batch_width; i++)\r\n\t\t{\r\n\t\t\tthis.__set_pixel_rgb(data_texture.src, i, v3, true, true, true);\r\n\t\t\tdata_texture.dirty_count++;\r\n\t\t}\r\n\t}\r\n\r\n\t__flood_data_texture_rgba(data_texture, v4)\r\n\t{\r\n\t\tfor(let i=0; i< this.batch_width * this.batch_width; i++)\r\n\t\t{\r\n\t\t\tthis.__set_pixel_rgba(data_texture.src, i, v4, true, true, true, true);\r\n\t\t\tdata_texture.dirty_count++;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\t__create_rgb_texture(width)\r\n\t{\r\n\t\tlet data = new Uint8Array( 3 * width * width );\r\n\t\treturn new THREE.DataTexture( data, width, width, THREE.RGBFormat );\r\n\t}\r\n\t__create_rgba_texture(width)\r\n\t{\r\n\t\tlet data = new Uint8Array( 4 * width * width );\r\n\t\treturn new THREE.DataTexture( data, width, width, THREE.RGBAFormat );\r\n\t}\r\n\r\n\t__create_rgba_float_texture(width)\r\n\t{\r\n\t\tlet data = new Float32Array( 4 * width * width );\r\n\t\treturn new THREE.DataTexture( data, width, width, THREE.RGBA, THREE.FloatType );\r\n\t}\r\n\r\n\t__get_data_texture(uniform_name)\r\n\t{\r\n\t\tfor(let i=0; i< this.data_textures.length; i++)\r\n\t\t{\r\n\t\t\tif(this.data_textures[i].name === uniform_name)\r\n\t\t\t\treturn this.data_textures[i];\r\n\t\t}\r\n\t\tconosle.error(\"Data texture \"+uniform_name+\" does not exist\");\r\n\t\treturn undefined;\r\n\t}\r\n\t__get_object_index(name)\r\n\t{\r\n\t\tfor(let i=0; i< this.object_names.length; i++)\r\n\t\t{\r\n\t\t\tif(this.object_names[i] === name)\r\n\t\t\t\treturn i;\r\n\t\t}\r\n\t\tconsole.error(\"the name \"+name+\" is not contained in this batch\");\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t__add_data_texture(uniform_name, src_texture, dst_texture, one_pixel_text)\r\n\t{\r\n\t\tdst_texture.needsUpdate = true;\r\n\r\n\t\tthis.data_textures.push({\r\n\t\t\tname: uniform_name,\r\n\t\t\tsrc: src_texture, \r\n\t\t\tdst: dst_texture,\r\n\t\t\tone_pixel: one_pixel_text,\r\n\t\t\tlast_accessed_index: -1,\r\n\t\t\tdirty_count: 0\r\n\t\t});\r\n\r\n\t\tthis.uniforms[uniform_name] = {value: dst_texture};\r\n\t\treturn this.data_textures[this.data_textures.length-1];\r\n\t}\r\n\r\n\tdispose()\r\n\t{\r\n\t\tfor(let i=0; i< this.data_textures.length; i++)\r\n\t\t{\r\n\t\t\tthis.data_textures[i].src.dispose();\r\n\t\t\tthis.data_textures[i].dst.dispose();\r\n\t\t\tthis.data_textures[i].one_pixel.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n}","import GeometryBatch from '/static_batcher/GeometryBatch'\r\n\r\nclass GeometryBatcher\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.batches = [];\r\n\t}\r\n\r\n\tbatch(buffer_geometries)\r\n\t{\r\n\t  let attr_accessor_uvs = [];\r\n\t  let texture_width = THREE.Math.ceilPowerOfTwo(Math.sqrt(buffer_geometries.length));\r\n\t  // console.log(\"Store count: \" + buffer_geometries.length + \", Texture size: \" +texture_width);\r\n\r\n\t  this.__init_uv_array(attr_accessor_uvs, texture_width);\r\n\r\n\r\n\t  let uv_index = 0;\r\n\r\n\t  for(let i=0; i< buffer_geometries.length; i++)\r\n\t  {\r\n\t    let vertex_count = buffer_geometries[i].getAttribute('position').count;\r\n\t    let y = Math.floor(i/texture_width);\r\n\t    let x = i - texture_width*y;\r\n\t    for(let count = 0; count < vertex_count; count++)\r\n\t    {\r\n\r\n\t      attr_accessor_uvs[uv_index] = (x/texture_width) + 0.5/texture_width;\r\n\t      attr_accessor_uvs[uv_index+1] = (y/texture_width) + 0.5/texture_width;\r\n\t      uv_index+=2;\r\n\t    }\r\n\t  }\r\n\r\n\t  let buffer_attribute = new THREE.BufferAttribute( new Float32Array( attr_accessor_uvs ), 2);\r\n\t  let buffer_geometry = THREE.BufferGeometryUtils.mergeBufferGeometries(buffer_geometries);\r\n\t  buffer_geometry.addAttribute( 'attr_accessor_uv', buffer_attribute);\r\n\r\n\t  this.batches.push(new GeometryBatch(buffer_geometry, texture_width));\r\n\t  return this.batches[this.batches.length-1];\r\n\r\n\t}\r\n\r\n\tupload_texture_data(renderer)\r\n\t{\r\n\t\tfor(let i=0; i< this.batches.length; i++)\r\n\t\t{\r\n\t\t\tthis.batches[i].upload_texture_data(renderer, 1);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\r\n\t__init_uv_array(uvs, texture_width)\r\n\t{\r\n\t\tfor(let i=0; i< texture_width*texture_width*2; i++)\r\n\t  {\r\n\t    uvs.push(0);\r\n\t  }\r\n\t}\r\n}\r\n\r\n\r\nconst geometry_batcher = new GeometryBatcher();\r\nmodule.exports = geometry_batcher;\r\n","import Time from '/Time';\r\nimport Input from '/Input';\r\nimport UI from '/UI';\r\nimport Debug from '/Debug';\r\nimport GeometryBatcher from '/static_batcher/GeometryBatcher';\r\nimport BaseApplication from '/BaseApplication';\r\n\r\nexport default class RenderLoop {\r\n\r\n  constructor(target_application, renderer) {\r\n\r\n    target_application = target_application || new BaseApplication();\r\n\r\n    this._frame_id = -1;\r\n\r\n    this.target_application = target_application;\r\n    this.renderer = renderer;\r\n\r\n    this.is_running = true;\r\n\r\n  }\r\n\r\n  update() {\r\n\r\n    if(!this.is_running)\r\n      return;\r\n\r\n    Time.__update();\r\n    Debug.clear();\r\n\r\n    //###### START CYCLE ######\r\n\r\n    this.target_application.update();\r\n\r\n    this.target_application.on_pre_render();\r\n\r\n    this.renderer.update();     // render scene\r\n    UI.update();                // update after new camera matrix has been calculated\r\n    UI.render(this.renderer);   // render ui layer on top\r\n\r\n    this.target_application.on_post_render();\r\n\r\n    if(Debug.rt_debug)\r\n      this.renderer.blit(Debug.rt_debug);\r\n    //###### END  CYCLE #######\r\n    Input.clear();\r\n    UI.clear();\r\n\r\n    //   GeometryBatcher.upload_texture_data(this.renderer);\r\n\r\n    this._frame_id = requestAnimationFrame(this.update.bind(this));\r\n  }\r\n\r\n  start() {\r\n    this.target_application.start();\r\n    this.update();\r\n    this.is_running = true;\r\n\r\n\r\n  }\r\n\r\n  stop() {\r\n    this.is_running = false;\r\n    this.target_application.end();\r\n\r\n    cancelAnimationFrame(this._frame_id);\r\n  }\r\n}\r\n","export default class AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tthis.progress = 0;\r\n\t\tthis.resource_id = resource_id;\r\n\t\tthis.url = url;\r\n\r\n\t\tthis.has_finished = false;\r\n\t\tthis.has_error = false;\r\n\t\tthis.error_message = \"none\";\r\n\t}\r\n\r\n\t__update_progress(value)\r\n\t{\r\n\t\tthis.progress = value;\r\n\t}\r\n\t__loading_ended()\r\n\t{\r\n\t\tthis.has_finished = true;\r\n\t}\r\n\t__set_error(message)\r\n\t{\r\n\t\tthis.has_error = true;\r\n\t\tthis.error_message = message;\r\n\t}\r\n\r\n\tprint_error()\r\n\t{\r\n\t\tconsole.error(\"Error while loading \"+this.resource_id+\"\\n\\t path: \"+this.url+\"\\n\\t\\t\"+this.error_message);\r\n\t}\r\n\r\n\tload(resource_container) {\r\n\r\n\t}\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class TextureLoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.TextureLoader();\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\r\n\t\tthis.loader.load(\tthis.url, (image)=> {\r\n\t\t\tresource_container.set_resource(ctx.resource_id, image);\r\n\t\t\t\tctx.__update_progress(1);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t},\r\n\t\t\tundefined,\r\n\t\t\t() => {\r\n\t\t\t\tctx.__set_error(\"Image could not  be loaded. Maybe wrong name or path, I don't know\" + '\\\\_()_/');\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class GLTFLoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.GLTFLoader();\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\r\n\t\tthis.loader.load(\tthis.url, (gltf)=> {\r\n\t\t\tresource_container.set_resource(ctx.resource_id, gltf);\r\n\t\t\t\tctx.__update_progress(1);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t},\r\n\t\t\t(xhr) =>{\r\n\t\t\t\tctx.__update_progress(xhr.loaded/xhr.total);\r\n\t\t\t},\r\n\t\t\t(msg) => {\r\n\t\t\t\tctx.__set_error(msg +\"\\n\\n\\t If the error says something about unexpected token < in JSON then the probably the problem is related to the file not being found. Check the name and path of the resource\");\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class DAELoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.ColladaLoader();\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\r\n\t\tthis.loader.load(\tthis.url, (gltf)=> {\r\n\t\t\tresource_container.set_resource(ctx.resource_id, gltf);\r\n\t\t\t\tctx.__update_progress(1);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t},\r\n\t\t\t(xhr) =>{\r\n\t\t\t\tctx.__update_progress(xhr.loaded/xhr.total);\r\n\t\t\t},\r\n\t\t\t(msg) => {\r\n\t\t\t\tctx.__set_error(msg +\"\\n\\n\\t If the error says something about unexpected token < in JSON then the probably the problem is related to the file not being found. Check the name and path of the resource\");\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class TextLoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.FileLoader();\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\r\n\t\tthis.loader.load(\tthis.url, (gltf)=> {\r\n\t\t\tresource_container.set_resource(ctx.resource_id, gltf);\r\n\t\t\t\tctx.__update_progress(1);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t},\r\n\t\t\t(xhr) =>{\r\n\t\t\t\tctx.__update_progress(xhr.loaded/xhr.total);\r\n\t\t\t},\r\n\t\t\t(msg) => {\r\n\t\t\t\tctx.__set_error(msg);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class CubemapLoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.CubeTextureLoader();\r\n\r\n\t\tthis.urls = [];\r\n\t\tthis.urls.push(url);\r\n\t\tthis.urls.push(url);\r\n\t\tthis.urls.push(url);\r\n\t\tthis.urls.push(url);\r\n\t\tthis.urls.push(url);\r\n\t\tthis.urls.push(url);\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\r\n\t\tthis.loader.load(\tthis.urls, (image)=> {\r\n\t\t\tresource_container.set_resource(ctx.resource_id, image);\r\n\t\t\t\tctx.__update_progress(1);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t},\r\n\t\t\tundefined,\r\n\t\t\t(error) => {\r\n\t\t\t\tctx.__set_error(\"Image could not  be loaded. Maybe wrong name or path, I don't know\" + '\\\\_()_/', error);\r\n\t\t\t\tctx.__loading_ended()\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class AudioLoader extends AbstractLoader\r\n{\r\n\tconstructor(resource_id, url, listener, loop, volume)\r\n\t{\r\n\t\tsuper(resource_id, url);\r\n\t\tthis.loader = new THREE.AudioLoader();\r\n\t\tthis.loop = loop;\r\n\t\tthis.listener = listener;\r\n\t\tthis.voluem = volume;\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tlet ctx = this;\r\n\t\tlet sound = new THREE.Audio(this.listener);\r\n\r\n\t\tthis.loader.load(this.url, (audio)=> {\r\n\t\t\tsound.setBuffer(audio);\r\n\t\t\tsound.setLoop(this.loop);\r\n\t\t\tsound.setVolume(this.voluem);\r\n\r\n\t\t\tresource_container.set_resource(ctx.resource_id, sound);\r\n\r\n\t\t\tif (!resource_container.get_resource('audio_listener')) {\r\n\t\t\t\tresource_container.set_resource('audio_listener', this.listener);\r\n\t\t\t}\r\n\r\n\t\t\tctx.__update_progress(1);\r\n\t\t\tctx.__loading_ended()\r\n\t\t},\r\n\t\tundefined,\r\n\t\t(error) => {\r\n\t\t\tctx.__set_error(\"Audio could not be loaded. Maybe wrong name or path, I don't know\" + '\\\\_()_/', error);\r\n\t\t\tctx.__loading_ended()\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","import AbstractLoader from '/resource_loader/AbstractLoader';\r\n\r\nexport default class JSONLoader extends AbstractLoader {\r\n\tconstructor(resource_id, url, username, password) {\r\n\t\tsuper(resource_id, url);\r\n\r\n\t\tthis.loader = new THREE.FileLoader();\r\n\t\tthis.username = username;\r\n\t\tthis.password = password;\r\n\t\tthis.resource_container = undefined;\r\n\t}\r\n\r\n\tload(resource_container) {\r\n\t\t// let headers = new Headers();\r\n\t\tlet headers = {};\r\n\t\tthis.resource_container = resource_container;\r\n\r\n\t\tif (this.username !== undefined && this.password !== undefined) {\r\n\t\t\theaders['Authorization'] = `Basic ${btoa(`${this.username}:${this.password}`)}`\r\n\t\t}\r\n\r\n\t\tfetch(this.url, { headers: headers })\r\n\t\t\t.then(this.__parse_to_json.bind(this))\r\n\t\t\t.then(this.__set_resource.bind(this))\r\n\t}\r\n\r\n\t__parse_to_json(response) {\r\n\t\treturn response.json();\r\n\t}\r\n\r\n\t__set_resource(data) {\r\n\t\tthis.resource_container.set_resource(this.resource_id, data);\r\n\r\n\t\tthis.__update_progress(1);\r\n\t\tthis.__loading_ended();\r\n\t}\r\n\r\n}\r\n","import EventManager from '/EventManager';\r\n\r\nclass ResourceContainer\r\n{\r\n\tconstructor()\r\n\t{\r\n\t\tthis.resources = {};\r\n\t}\r\n\r\n\tset_resource(name, resource)\r\n\t{\r\n\t\tthis.resources[name] = resource;\r\n\t\tEventManager.fire_resource_loaded({name: name, value: resource});\r\n\t}\r\n\r\n\tget_resource(name)\r\n\t{\r\n\t\treturn this.resources[name];\r\n\t}\r\n\r\n}\r\n\r\nconst resource_container = new ResourceContainer();\r\nmodule.exports = resource_container;\r\n","import TextureLoader from '/resource_loader/TextureLoader';\r\nimport GLTFLoader from '/resource_loader/GLTFLoader';\r\nimport DAELoader from '/resource_loader/DAELoader';\r\nimport TextLoader from '/resource_loader/TextLoader';\r\nimport CubemapLoader from '/resource_loader/CubemapLoader';\r\nimport AudioLoader from '/resource_loader/AudioLoader';\r\nimport JSONLoader from '/resource_loader/JSONLoader';\r\nimport ResourceContainer from '/ResourceContainer';\r\n\r\nexport default class ResourceBatch\r\n{\r\n\tconstructor(batch_name)\r\n\t{\r\n\t\tthis.resource_loaders = [];\r\n\t\tthis.batch_name = batch_name || \"unnamed batch\";\r\n\t}\r\n\r\n\tadd_texture(resource_id, url)\r\n\t{\r\n\t\tthis.resource_loaders.push(new TextureLoader(resource_id, url));\r\n\t}\r\n\r\n\tadd_gltf(resource_id, url)\r\n\t{\r\n\t\tthis.resource_loaders.push(new GLTFLoader(resource_id, url));\r\n\t}\r\n\tadd_dae(resource_id, url)\r\n\t{\r\n\t\tthis.resource_loaders.push(new DAELoader(resource_id, url));\r\n\t}\r\n\tadd_text(resource_id, url)\r\n\t{\r\n\t\tthis.resource_loaders.push(new TextLoader(resource_id, url));\r\n\t}\r\n\tadd_cubemap(resource_id, url)\r\n\t{\r\n\t\tthis.resource_loaders.push(new CubemapLoader(resource_id, url));\r\n\t}\r\n\tadd_audio(resource_id, url, listener, loop, volume) {\r\n\t\tthis.resource_loaders.push(new AudioLoader(resource_id, url, listener, loop, volume));\r\n\t}\r\n\tadd_json(resource_id, url, username, password) {\r\n\t\tthis.resource_loaders.push(new JSONLoader(resource_id, url, username, password));\r\n\t}\r\n\r\n\tload(resource_container)\r\n\t{\r\n\t\tfor(let i=0; i< this.resource_loaders.length; i++)\r\n\t\t{\r\n\t\t\tthis.resource_loaders[i].load(resource_container || ResourceContainer);\r\n\t\t}\r\n\t}\r\n\r\n\tget loading_finished()\r\n\t{\r\n\t\tlet finished = true;\r\n\t\tfor(let i=0; i< this.resource_loaders.length; i++)\r\n\t\t{\r\n\t\t\tfinished = finished && this.resource_loaders[i].has_finished;\r\n\t\t}\r\n\t\treturn finished;\r\n\t}\r\n\r\n\tget has_errors()\r\n\t{\r\n\t\tlet has_error = false;\r\n\t\tfor(let i=0; i< this.resource_loaders.length; i++)\r\n\t\t{\r\n\t\t\thas_error = has_error || this.resource_loaders[i].has_error;\r\n\t\t}\r\n\t\treturn has_error;\r\n\t}\r\n\r\n\tprint_errors()\r\n\t{\r\n\t\tconsole.error(\"Batch <\"+this.batch_name+\"> could not load successfully\")\r\n\t\tfor(let i=0; i< this.resource_loaders.length; i++)\r\n\t\t{\r\n\t\t\tif(this.resource_loaders[i].has_error)\r\n\t\t\t\tthis.resource_loaders[i].print_error();\r\n\t\t}\r\n\t}\r\n\r\n\tget_progress()\r\n\t{\r\n\t\tlet progress = 0;\r\n\t\tfor(let i=0; i< this.resource_loaders.length; i++)\r\n\t\t{\r\n\t\t\tprogress+=this.resource_loaders[i].progress;\r\n\t\t}\r\n\t\treturn progress/this.resource_loaders.length;\r\n\t}\r\n}\r\n","// This class helps with parsing an entire recording that spans several days, into one-day recordings\r\n// that start at 0:00:00 and ends at 23:59:59, except for the first and last day of a recording range\r\nexport default class TimeUtilities\r\n{\r\n\tconstructor(){}\r\n\r\n\r\n  static get full_day_ms()\r\n  {\r\n    return 86400000;\r\n  }\r\n\r\n  static get_days_between(start_date, end_date)\r\n  {\r\n  \t// \tlet startDate = moment.parseZone(\"2020-03-15T18:31:23.623794-04:00\");\r\n\t\t// let endDate \t= moment.parseZone(\"2020-03-23T12:17:06.815451-04:00\");\r\n  \tlet startDate = moment.parseZone(start_date);\r\n\t\tlet endDate \t= moment.parseZone(end_date);\r\n\t\tlet duration  = moment.duration(endDate.diff(startDate));\r\n    let days \t\t\t= Math.ceil(duration.asDays());\r\n\r\n\t\tlet start,end;\r\n\t\tlet days_array = [];\r\n\r\n    for(let i = 0; i<=days; i++){\r\n\r\n      if(startDate.date() === endDate.date())\r\n      {\r\n        start = startDate;\r\n        end = endDate;\r\n      }\r\n      else\r\n      {\r\n        if(i == 0){\r\n          start = startDate;\r\n          end = moment(startDate).endOf(\"day\");\r\n        }else if(i == days){\r\n          start = moment(endDate).startOf('day');\r\n          end = endDate;\r\n        } else {\r\n          start = moment(startDate).add('days', i).startOf('day');\r\n          end = moment(startDate).add('days', i).endOf('day');\r\n        }\r\n      }\r\n\r\n\r\n\t\t  days_array.push({\r\n\t\t  \tstart: moment(start),\r\n\t\t  \tend: moment(end),\r\n\t\t  \tduration_in_seconds: moment.duration(moment(end).diff(moment(start))).asSeconds(),\r\n        absolute_start_date: start_date,\r\n        absolute_end_date: end_date\r\n\t\t  })\r\n\r\n\t\t}\r\n\r\n\t\treturn days_array;\r\n  }\r\n\r\n}\r\n\r\n","export default class Validation\r\n{\r\n\tconstructor(){}\r\n\r\n  static is_int(n) {\r\n    return Number(n) === n && n % 1 === 0;\r\n  }\r\n\r\n  static is_float(n) {\r\n    return Number(n) === n && n % 1 !== 0;\r\n  }\r\n}\r\n","module.exports=\"#define GLSLIFY 1\\nuniform vec3 _Color;\\n\\nvarying vec3 vBarycentric;\\n\\nfloat edgeFactor(vec3 baryc ){\\n    vec3 d = fwidth(baryc);\\n    vec3 a3 = smoothstep(vec3(0.0), d*1.5, baryc);\\n    return min(min(a3.x, a3.y), a3.z);\\n}\\n\\nvoid main()\\n{\\t\\n\\tfloat alpha = edgeFactor(vBarycentric + vec3(1. , 1., 0.));\\n\\tgl_FragColor.rgb = mix(_Color, vec3(0.), alpha);\\n\\tgl_FragColor.a = 1.0 - alpha;\\n\\tgl_FragColor.a *= 0.2;\\n}\";","module.exports=\"#define GLSLIFY 1\\nattribute vec3 barycentric;\\nvarying vec3 vBarycentric;\\nvoid main()\\n{\\n\\n  mat4 VP = projectionMatrix * viewMatrix;\\n  vec3 pos = (modelMatrix * vec4(position, 1.0)).xyz;\\n  gl_Position = VP * vec4(pos, 1.0);\\n  vBarycentric = barycentric;\\n}\";","export default class GeometryUtilities\r\n{\r\n\tstatic convert_to_non_indexed_geometry(geometry_buffer)\r\n\t{\r\n\t\tlet indices = geometry_buffer.index;\r\n\t\tlet positions = geometry_buffer.getAttribute(\"position\");\r\n\r\n\t\tlet bar_coordinates = [];\r\n\t\tlet vertices = [];\r\n\r\n\t\tfor(let i=0; i< indices.count; i+=3)\r\n\t\t{\r\n\t\t\t// VERTEX 1\r\n\t\t\tvertices.push(positions.getX(indices.array[i+0]));\r\n\t\t\tvertices.push(positions.getY(indices.array[i+0]));\r\n\t\t\tvertices.push(positions.getZ(indices.array[i+0]));\r\n\r\n\t\t\tbar_coordinates.push(1);\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(0);\r\n\r\n\r\n\t\t\t// VERTEX 2\r\n\r\n\t\t\tvertices.push(positions.getX(indices.array[i+1]));\r\n\t\t\tvertices.push(positions.getY(indices.array[i+1]));\r\n\t\t\tvertices.push(positions.getZ(indices.array[i+1]));\r\n\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(1);\r\n\t\t\tbar_coordinates.push(0);\r\n\r\n\r\n\t\t\t// VERTEX 3\r\n\r\n\t\t\tvertices.push(positions.getX(indices.array[i+2]));\r\n\t\t\tvertices.push(positions.getY(indices.array[i+2]));\r\n\t\t\tvertices.push(positions.getZ(indices.array[i+2]));\r\n\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(1);\r\n\r\n\r\n\t\t}\r\n\r\n\t\tlet geometry = new THREE.BufferGeometry();\r\n\t\t// geometry.addAttribute('barycentric', new THREE.BufferAttribute( new Float32Array(bar_coordinates), 3 ));\r\n\t\tgeometry.addAttribute('position', new THREE.BufferAttribute( new Float32Array(vertices), 3 ) );\r\n\t\tGeometryUtilities.add_barycentric_attribute(geometry);\r\n\t\treturn geometry;\r\n\t}\r\n\r\n\tstatic add_barycentric_attribute(non_indexed_geometry_buffer)\r\n\t{\r\n\t\tlet bar_coordinates = [];\r\n\t\tlet positions = non_indexed_geometry_buffer.getAttribute(\"position\");\r\n\r\n\t\tfor(let i=0; i< positions.count; i+=3)\r\n\t\t{\r\n\t\t\tbar_coordinates.push(1);\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(0);\r\n\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(1);\r\n\t\t\tbar_coordinates.push(0);\r\n\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(0);\r\n\t\t\tbar_coordinates.push(1);\r\n\r\n\t\t}\r\n\t\tnon_indexed_geometry_buffer.addAttribute('barycentric', new THREE.BufferAttribute( new Float32Array(bar_coordinates), 3 ));\r\n\t}\r\n}\r\n","import grid_frag from '/shaders/grid/grid_frag';\r\nimport grid_vert from '/shaders/grid/grid_vert';\r\nimport GeometryUtilities from '/utilities/GeometryUtilities';\r\n\r\nexport default class Grid extends THREE.Mesh {\r\n\tconstructor()\r\n\t{\r\n\r\n\t\tlet material = new THREE.ShaderMaterial({\r\n      uniforms: {\r\n      \t_Color: {value: new THREE.Color(\"#919191\")}\r\n      },\r\n      vertexShader: grid_vert,\r\n      fragmentShader: grid_frag,\r\n      extensions: {derivatives: true},\r\n      transparent: true,\r\n      depthWrite: false\r\n    });\r\n\r\n\r\n    let plane_geometry = new THREE.PlaneBufferGeometry( 100, 100, 100,100 );\r\n\r\n\t\tlet non_indexed_geometry = GeometryUtilities.convert_to_non_indexed_geometry(plane_geometry);\r\n\r\n\t\tsuper(non_indexed_geometry, material);\r\n\r\n\t\tthis.rotation.x = -3.14/2;\r\n\t}\r\n\r\n}\r\n","import Grid from '/components/Grid';\r\nexport default {\r\n  Grid: Grid\r\n}\r\n","import BaseApplication from '/BaseApplication';\r\nimport CameraManager from '/CameraManager';\r\nimport CameraUtilities from '/utilities/CameraUtilities';\r\nimport Capabilities from '/Capabilities';\r\nimport Configuration from '/Configuration';\r\nimport EasingFunctions from '/utilities/EasingFunctions';\r\nimport EventManager from '/EventManager';\r\nimport Debug from '/Debug';\r\nimport Graphics from '/Graphics';\r\nimport Input from '/Input';\r\nimport MathUtilities from '/utilities/MathUtilities';\r\nimport NormalRender from '/render_mode/NormalRender';\r\nimport ObjectUtilities from '/utilities/ObjectUtilities';\r\nimport PerspectiveCamera from '/PerspectiveCamera';\r\nimport RenderLoop from '/RenderLoop';\r\nimport ResourceBatch from '/resource_loader/ResourceBatch';\r\nimport ResourceContainer from '/ResourceContainer';\r\nimport SceneManager from '/SceneManager';\r\nimport Screen from '/Screen';\r\nimport Time from '/Time';\r\nimport TimeUtilities from '/utilities/TimeUtilities';\r\nimport Validation from '/utilities/Validation';\r\nimport Components from '/Components';\r\nmodule.exports = {\r\n  BaseApplication: BaseApplication,\r\n  CameraManager: CameraManager,\r\n  CameraUtilities: CameraUtilities,\r\n  Capabilities: Capabilities,\r\n  Configuration: Configuration,\r\n  EasingFunctions: EasingFunctions,\r\n  EventManager: EventManager,\r\n  Debug: Debug,\r\n  Graphics: Graphics,\r\n  Input: Input,\r\n  MathUtilities: MathUtilities,\r\n  NormalRender: NormalRender,\r\n  ObjectUtilities: ObjectUtilities,\r\n  PerspectiveCamera: PerspectiveCamera,\r\n  RenderLoop: RenderLoop,\r\n  ResourceBatch: ResourceBatch,\r\n  ResourceContainer: ResourceContainer,\r\n  SceneManager: SceneManager,\r\n  Screen: Screen,\r\n  Time: Time,\r\n  TimeUtilities: TimeUtilities,\r\n  Validation: Validation,\r\n  Components: Components\r\n}\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n","export default class CameraViewState\r\n{\r\n\tconstructor()\t{\t}\r\n\r\n\ton_enter(camera_controller)\t{\t}\r\n\r\n\ton_exit(camera_controller)\t{\t}\r\n\r\n\tupdate(TIME, camera_controller)\t{\t}\r\n\r\n}","import CameraViewState from '../states/CameraViewState'\r\n\r\nimport {Input}  from 'ohzi-core';\r\nimport {CameraUtilities} from 'ohzi-core';\r\n\r\nexport default class CameraDebugState extends CameraViewState\r\n{\r\n\r\n  constructor(oobb){\r\n    super();\r\n    this.pan_speed = new THREE.Vector2();\r\n\r\n    this.zoom_speed = 0;\r\n    this.zoom_t = 0;\r\n\r\n    this.tilt_degrees = 70;\r\n    this.tilt_speed = 0;\r\n\r\n    this.vector_down_axis = new THREE.Vector3(0,-1,0);\r\n    this.vector_up_axis   = new THREE.Vector3(0,1,0);\r\n    this.vector_back_axis = new THREE.Vector3(0,0,-1);\r\n    this.vector_left_axis = new THREE.Vector3(-1,0,0);\r\n\r\n    this.tmp_dir = new THREE.Vector3();\r\n    this.tmp_ray = new THREE.Ray();\r\n\r\n    this.tmp_intersection = new THREE.Vector3();\r\n    this.tmp_mouse_dir = new THREE.Vector2();\r\n\r\n    this.last_point = new THREE.Vector3();\r\n\r\n  }\r\n\r\n  \r\n  on_enter (camera_controller) {\r\n    this.t_damping = 0;\r\n  }\r\n\r\n  on_exit(camera_controller)\r\n  {\r\n  }\r\n\r\n  update (camera_controller) {\r\n  \tif(!camera_controller.input_enabled)\r\n  \t{\r\n  \t\treturn;\r\n  \t}\r\n\r\n    if(camera_controller.camera.isOrthographicCamera)\r\n    {\r\n      camera_controller.reference_zoom += Input.wheel_delta *2 ;\r\n    }else\r\n    {\r\n      camera_controller.reference_zoom += Input.wheel_delta *2 ;\r\n    }\r\n    if(Input.left_mouse_button_down)\r\n    {\r\n\r\n      camera_controller.set_rotation_delta(Input.mouse_dir.x * -0.5, \r\n                                          Input.mouse_dir.y * 0.8);\r\n    }\r\n\r\n\r\n    if(Input.right_mouse_button_pressed)\r\n    {\r\n      this.last_point.copy(Input.NDC);\r\n    }\r\n    if(Input.right_mouse_button_down)\r\n    {\r\n      let prev_point    = CameraUtilities.get_plane_intersection(camera_controller.reference_position, undefined, this.last_point).clone();\r\n      let current_point = CameraUtilities.get_plane_intersection(camera_controller.reference_position, undefined, Input.NDC).clone();\r\n      current_point.sub(prev_point);\r\n\r\n      camera_controller.reference_position.x -= current_point.x;\r\n      camera_controller.reference_position.y -= current_point.y;\r\n      camera_controller.reference_position.z -= current_point.z;\r\n      \r\n      this.last_point.copy(Input.NDC);\r\n    }\r\n  }\r\n\r\n\r\n  clamp(a,b,c)\r\n  {\r\n    return Math.max(b,Math.min(c,a));\r\n  }\r\n  step(a,b)\r\n  {\r\n    if(b > a)\r\n      return 1;\r\n    return 0;\r\n  }\r\n\r\n  linear_map(value,\r\n             from_range_start_value,\r\n             from_range_end_value,\r\n             to_range_start_value,\r\n             to_range_end_value)\r\n    {\r\n        return ((value - from_range_start_value)/ (from_range_end_value - from_range_start_value)) * (to_range_end_value - to_range_start_value) + to_range_start_value;\r\n    }\r\n\r\n  \r\n\r\n}","export default class CameraMovementMode\r\n{\r\n\tconstructor()\t{\t}\r\n\r\n\ton_enter(camera_controller)\t{\t}\r\n\r\n\ton_exit(camera_controller)\t{\t}\r\n\r\n\tupdate(TIME, camera_controller)\t{\t}\r\n\r\n}","\r\nimport CameraMovementMode from './CameraMovementMode'\r\n\r\n\r\nexport default class ImmediateMode extends CameraMovementMode {\r\n\r\n  constructor() {\r\n    super();\r\n    this.rotation_speed = new THREE.Vector2();\r\n\r\n    this.vector_up_axis = new THREE.Vector3(0, 1, 0);\r\n    this.vector_forward_axis = new THREE.Vector3(0, 0, -1);\r\n    this.tmp_up1 = new THREE.Vector3();\r\n    this.tmp_up2 = new THREE.Vector3();\r\n    this.tmp_forward = new THREE.Vector3();\r\n\r\n\r\n    this.tmp_new_pos = new THREE.Vector3();\r\n\r\n    this.tmp_quat = new THREE.Quaternion();\r\n    this.tmp_camera_target_pos = new THREE.Vector3();\r\n  }\r\n\r\n\r\n  on_enter(camera_controller) {\r\n    camera_controller.reference_rotation.copy(camera_controller.camera.quaternion);\r\n  }\r\n\r\n\r\n  update(camera_controller) {\r\n\r\n\r\n    camera_controller.camera.quaternion.copy(camera_controller.reference_rotation);\r\n    // camera_controller.camera.quaternion.slerp(camera_controller.reference_rotation, 0.8);\r\n\r\n    this.tmp_forward.copy(this.vector_forward_axis);\r\n    let dir = this.tmp_forward.applyQuaternion(camera_controller.camera.quaternion);\r\n\r\n    camera_controller.reference_zoom = THREE.Math.clamp(camera_controller.reference_zoom,\r\n      camera_controller.min_zoom, camera_controller.max_zoom);\r\n\r\n\r\n    camera_controller.camera.position.copy(camera_controller.reference_position).sub(dir.multiplyScalar(camera_controller.reference_zoom));\r\n\r\n    camera_controller.camera.up.copy(new THREE.Vector3(0, 1, 0).applyQuaternion(camera_controller.camera.quaternion));\r\n    camera_controller.camera.lookAt(camera_controller.reference_position);\r\n\r\n    camera_controller.__last_reference_position.copy(camera_controller.reference_position);\r\n\r\n  }\r\n\r\n  get_target_camera_pos(camera_controller) {\r\n    this.tmp_quat.copy(camera_controller.reference_rotation);\r\n    this.tmp_forward.copy(this.vector_forward_axis);\r\n\r\n    let dir = this.tmp_forward.applyQuaternion(this.tmp_quat);\r\n\r\n    let zoom = THREE.Math.clamp(camera_controller.reference_zoom,\r\n      camera_controller.min_zoom, camera_controller.max_zoom);\r\n\r\n\r\n    this.tmp_camera_target_pos.copy(camera_controller.reference_position).sub(dir.multiplyScalar(zoom));\r\n    return this.tmp_camera_target_pos;\r\n\r\n  }\r\n\r\n}\r\n","import CameraViewState from './states/CameraViewState'\r\nimport CameraDebugState from './states/CameraDebugState'\r\n// import CameraPanAndZoom from './states/CameraPanAndZoom'\r\n// import FreeMove from './states/FreeMove'\r\nimport ImmediateMode from './movement_mode/ImmediateMode'\r\n\r\n// import EventManager from 'js/core/EventManager';\r\n// import RotateAndZoomAroundPoint from './movement_mode/RotateAndZoomAroundPoint'\r\nimport CameraMovementMode from './movement_mode/CameraMovementMode'\r\n\r\nimport {Input} from 'ohzi-core';\r\nimport {CameraManager} from 'ohzi-core'\r\nimport {Screen} from 'ohzi-core';\r\n\r\nexport default class CameraController\r\n{\r\n\r\n\tconstructor(){\r\n\t\tthis.camera = undefined;\r\n\t\tthis.camera_initial_rot = undefined;\r\n\t\tthis.camera_initial_pos = undefined;\r\n\t\tthis.current_state = new CameraViewState();\r\n\r\n    this.current_mode = new ImmediateMode();\r\n\r\n\t\tthis.point_of_interest = new THREE.Vector3();\r\n\t\tthis.normalized_zoom = 0;\r\n\r\n\r\n    this.vector_up_axis   = new THREE.Vector3(0,1,0);\r\n    this.vector_right_axis = new THREE.Vector3(1,0,0);\r\n    this.vector_forward_axis = new THREE.Vector3(0,0,1);\r\n    this.tmp_forward = this.vector_forward_axis.clone();\r\n    this.tmp_right = this.vector_right_axis.clone();\r\n\r\n    this.tmp_dir = new THREE.Vector3();\r\n\r\n    this.zoom = 10;\r\n    this.reference_zoom = 10;\r\n    this.orientation = 27; // degrees\r\n    this.tilt = 70;\r\n\r\n    this.dx_movement = 0;\r\n    this.dy_movement = 0;\r\n\r\n    this.reference_rotation = new THREE.Quaternion();\r\n\t\tthis.reference_position = new THREE.Vector3();\r\n\t\tthis.__last_reference_position = new THREE.Vector3();\r\n\r\n\r\n\r\n\t\tthis.translation_damping = 0;\r\n\t\tthis.translation_response = 3.3;\r\n\r\n\t\tthis.zoom_damping = 0.08;\r\n\t\tthis.zoom_response = 5;\r\n\r\n\t\t//deprecated\r\n\t\tthis.zoom_speed_damping = 0.65;\r\n\t\tthis.zoom_speed = 5;\r\n\r\n\t\tthis.rotation_damping = 0;\r\n\t\tthis.rotation_response_time = 1;\r\n\r\n\t\tthis.tmp_size = new THREE.Vector3();\r\n\t\tthis.tmp_quat = new THREE.Quaternion();\r\n\r\n\t\tthis.min_zoom = 1;\r\n\t\tthis.max_zoom = 400;\r\n\r\n\t\tthis.current_tilt = 0;\r\n  \tthis.current_orientation = 0;\r\n\r\n  \tthis.input_enabled = true;\r\n  \t// this.debug_box = Debug.draw_cube(undefined,15);\r\n  \t// this.debug_zoom_box = Debug.draw_sphere(undefined,15, 0x00ff00);\r\n\t}\r\n\r\n\tset_camera(camera)\r\n\t{\r\n\t\tthis.camera = camera;\r\n\t\tthis.camera_initial_rot = camera.quaternion.clone();\r\n\t\tthis.camera_initial_pos = camera.position.clone();\r\n\t}\r\n\r\n\r\n\tset_state(state)\r\n\t{\r\n\t\t// console.log(\"camera controller state switch to: \" + state.constructor.name);\r\n\t\tthis.current_state.on_exit(this);\r\n\t\tthis.current_state = state;\r\n\t\tthis.current_state.on_enter(this);\r\n\t}\r\n\r\n\tset_mode(mode)\r\n\t{\r\n\t\t// console.log(\"camera controller mode switch to: \" + mode.constructor.name);\r\n\r\n\t\tthis.current_mode.on_exit(this);\r\n\t\tthis.current_mode = mode;\r\n\t\tthis.current_mode.on_enter(this);\r\n\t}\r\n\tset_normalized_zoom(zoom)\r\n\t{\r\n\t\tthis.normalized_zoom = THREE.Math.clamp(zoom, 0, 1);\r\n\t\t// EventManager.fire_zoom_changed(this.normalized_zoom);\r\n\t}\r\n\tupdate_normalized_zoom(min_zoom, max_zoom)\r\n\t{\r\n\t\tlet zoom = this.camera.position.distanceTo(this.reference_position);\r\n\t\tthis.normalized_zoom = this.linear_map(zoom, min_zoom, max_zoom, 1, 0);\r\n\t\tthis.normalized_zoom = THREE.Math.clamp(this.normalized_zoom, 0, 1);\r\n\t\t\r\n\t\t// EventManager.fire_zoom_changed(this.normalized_zoom);\r\n\r\n\t}\r\n\tupdate()\r\n\t{\r\n\t\tif(this.debug_box)\r\n  \t\tthis.debug_box.position.copy(this.reference_position);\r\n\r\n  \t// this.debug_zoom_box.position.copy(this.reference_position)\r\n  \t// this.debug_zoom_box.position.add(new THREE.Vector3(0,0,1).applyQuaternion(this.camera.quaternion).multiplyScalar(this.reference_zoom));\r\n\r\n\t\tthis.current_state.update(this);\r\n\t\tthis.current_mode.update(this);\r\n\t\tthis.update_normalized_zoom(this.min_zoom, this.max_zoom);\r\n\t}\r\n\r\n\r\n\tset_idle()\r\n\t{\r\n\t\tthis.set_state(new CameraViewState());\r\n\t}\r\n\r\n\tcamera_is_zoomed_out()\r\n\t{\r\n\t\treturn this.normalized_zoom < 0.2;\r\n\t}\r\n\r\n\tset_debug_mode()\r\n\t{\r\n\t\tthis.set_state(new CameraDebugState());\r\n\t}\r\n\r\n\r\n\r\n  set_rotation(tilt, orientation)\r\n  {\r\n  \tthis.old_orientation = this.current_orientation;\r\n\r\n  \tthis.current_tilt = tilt || this.current_tilt;\r\n  \tthis.current_orientation = orientation || this.current_orientation;\r\n    this.reference_rotation.copy(this.build_rotation(this.current_tilt, this.current_orientation));\r\n  }\r\n\r\n\r\n  set_tilt(tilt)\r\n  {\r\n    let new_tilt = new THREE.Quaternion().setFromAxisAngle(this.vector_right_axis, (-tilt/360) * Math.PI*2);\r\n    let old_tilt = new THREE.Quaternion().setFromAxisAngle(this.vector_right_axis, (-this.current_tilt/360) * Math.PI*2);\r\n    old_tilt.conjugate();\r\n\r\n  \tthis.reference_rotation.multiply(old_tilt).multiply(new_tilt);\r\n  \tthis.current_tilt = tilt;\r\n\r\n  }\r\n\r\n  set_rotation_delta(delta_x, delta_y)\r\n  {\r\n\r\n  \tthis.current_orientation = (this.current_orientation+delta_x) % 360;\r\n  \tthis.current_tilt += delta_y;\r\n\r\n  \tthis.current_orientation \r\n\r\n  \tthis.set_rotation(this.current_tilt, this.current_orientation);\r\n  }\r\n\r\n  lerp_rotation(from_tilt, to_tilt, from_orientation, to_orientation, t)\r\n  {\r\n  \tlet raw_orientation = THREE.Math.lerp(from_orientation, to_orientation, t);\r\n  \tif(Math.abs(to_orientation - from_orientation) > 180)\r\n  \t{\r\n  \t\tif(from_orientation > 180)\r\n  \t\t\tfrom_orientation = (from_orientation%360) - 360;\r\n  \t\tif(to_orientation > 180)\r\n  \t\t\tto_orientation = (to_orientation%360) - 360;\r\n  \t}\r\n\r\n  \tthis.set_rotation(THREE.Math.lerp(from_tilt, to_tilt, t), \r\n  \t\t\t\t\t\t\t\t\t\tTHREE.Math.lerp(from_orientation, to_orientation, t));\r\n  \tthis.current_orientation = raw_orientation\r\n  }\r\n\r\n\r\n  build_rotation(tilt, orientation)\r\n  {\r\n  \tlet new_orientation = new THREE.Quaternion().setFromAxisAngle(this.vector_up_axis, (orientation/360) * Math.PI*2);\r\n    let new_tilt = new THREE.Quaternion().setFromAxisAngle(this.vector_right_axis, (-tilt/360) * Math.PI*2);\r\n\r\n    return new_orientation.multiply(new_tilt);\r\n  }\r\n\r\n  translate_forward(amount)\r\n  {\r\n  \tthis.tmp_forward.copy(this.vector_forward_axis);\r\n  \tthis.tmp_forward.applyQuaternion(this.camera.quaternion);\r\n  \tthis.tmp_forward.y = 0;\r\n  \tthis.tmp_forward.normalize();\r\n  \tthis.reference_position.add(this.tmp_forward.multiplyScalar(amount));\r\n  }\r\n  translate_right(amount)\r\n  {\r\n  \tthis.tmp_right.copy(this.vector_right_axis);\r\n  \tthis.tmp_right.applyQuaternion(this.camera.quaternion);\r\n  \tthis.reference_position.add(this.tmp_right.multiplyScalar(amount));\r\n  }\r\n\r\n  linear_map(value,\r\n             from_range_start_value,\r\n             from_range_end_value,\r\n             to_range_start_value,\r\n             to_range_end_value)\r\n  {\r\n      return ((value - from_range_start_value)/ (from_range_end_value - from_range_start_value)) * (to_range_end_value - to_range_start_value) + to_range_start_value;\r\n  }\r\n\r\n  focus_camera_on_bounding_box(bb)\r\n  {\r\n  \tif(this.camera.isOrthographicCamera)\r\n  \t{\r\n  \t\tbb.getSize(this.tmp_size);\r\n\r\n  \t\tlet obj_x = this.tmp_size.x;\r\n  \t\tlet obj_y = this.tmp_size.y;\r\n  \t\tlet object_aspect = obj_x / obj_y;\r\n  \t\tif(Screen.aspect_ratio / object_aspect > 1)\r\n      \tthis.camera.zoom = Screen.height/obj_y;\r\n\t    else\r\n\t      this.camera.zoom = Screen.width/obj_x;\r\n\t    \r\n\t    bb.getCenter(this.reference_position);\r\n  \t}\r\n  \telse\r\n  \t{\r\n  \t\tlet dir = new THREE.Vector3();\r\n  \t\tdir.copy(bb.max).sub(bb.min);\r\n    \t\r\n  \t\tlet p1 = bb.min.clone();\r\n\r\n\r\n  \t\tlet p2 = p1.clone().add(new THREE.Vector3(dir.x, 0,0));\r\n  \t\tlet p3 = p1.clone().add(new THREE.Vector3(0, dir.y,0));\r\n  \t\tlet p4 = p1.clone().add(new THREE.Vector3(0, 0, dir.z));\r\n\r\n  \t\tlet p5 = p1.clone().add(new THREE.Vector3(dir.x, 0, dir.z));\r\n  \t\tlet p6 = p1.clone().add(new THREE.Vector3(0, dir.y, dir.z));\r\n  \t\tlet p7 = bb.max.clone();\r\n  \t\tlet p8 = p1.clone().add(new THREE.Vector3(dir.x, dir.y, 0));\r\n\r\n  \t\tthis.focus_camera_on_points([p1, p2, p3, p4, p5, p6, p7, p8], 1);\r\n\r\n\r\n  \t}\r\n  }\r\n\tget_zoom_to_focus_camera_on_bounding_box(bb, tilt, orientation)\r\n\t{\r\n\t\tif(tilt !== undefined && orientation !== undefined)\r\n\t\t{\r\n\t\t\tthis.tmp_quat.copy(this.reference_rotation); //backup quaternion\r\n\t\t\tthis.reference_rotation.copy(this.build_rotation(tilt, orientation));\r\n\t\t}\r\n\t\tlet original_zoom = this.reference_zoom;\r\n\t\tlet original_pos = new THREE.Vector3().copy(this.reference_position);\r\n\t\tthis.focus_camera_on_bounding_box(bb);\r\n\t\tlet target_zoom = this.reference_zoom;\r\n\t\tthis.reference_position.copy(original_pos);\r\n\t\tthis.reference_zoom = original_zoom;\r\n\r\n\t\tif(tilt !== undefined && orientation !== undefined)\r\n\t\t{\r\n\t\t\tthis.reference_rotation.copy(this.tmp_quat);\r\n\t\t}\r\n\r\n\t\treturn target_zoom;\r\n\t}\r\n\r\n\tget_zoom_to_focus_on_points(points, scale)\r\n\t{\r\n\t\tlet old_zoom = this.reference_zoom;\r\n\t\tlet old_pos = new THREE.Vector3().copy(this.reference_position);\r\n\t\tthis.focus_camera_on_points(points, scale);\r\n\t\tlet new_zoom = this.reference_zoom;\r\n\t\tthis.reference_zoom = old_zoom;\r\n\t\tthis.reference_position.copy(old_pos);\r\n\t\treturn new_zoom;\r\n\t}\r\n\tget_target_pos_to_focus_on_points(points, scale)\r\n\t{\r\n\t\tlet old_zoom = this.reference_zoom;\r\n\t\tlet old_pos = new THREE.Vector3().copy(this.reference_position);\r\n\t\tthis.focus_camera_on_points(points, scale);\r\n\t\tlet new_pos = this.reference_zoom.clone();\r\n\t\tthis.reference_zoom = old_zoom;\r\n\t\tthis.reference_position.copy(old_pos);\r\n\t\treturn new_pos;\r\n\t}\r\n\r\n\tfocus_camera_on_sphere(sphere, debug)\r\n\t{\r\n\t\tthis.reference_zoom = this.get_zoom_to_sphere(sphere, debug);\r\n\t\tthis.reference_position.copy(sphere.center);\r\n\t}\r\n\r\n\tget_zoom_to_sphere(sphere, debug)\r\n\t{\r\n\t\t\r\n\t\tlet v_fov = (this.camera.fov/2) * Math.PI/180;\r\n\t\tlet h_fov = (2 * Math.atan(Math.tan(v_fov) * this.camera.aspect))/2;\r\n\r\n\t\t// if(debug )\r\n\t\t// {\r\n\t\t// \tDebug.draw_math_sphere(sphere);\r\n\t\t// }\r\n\t\t//this.camera.zoom = 1/((sphere.radius*2) /(ViewApi.map.camera_controller.camera.top*2));\r\n    // this.camera.updateProjectionMatrix();\r\n\r\n    let distV = sphere.radius / Math.tan(v_fov);\r\n    let distH = sphere.radius / Math.tan(h_fov);\r\n    return Math.max(Math.abs(distH), Math.abs(distV));\r\n\t}\r\n\tfocus_camera_on_points(points, zoom_scale, debug)\r\n\t{\r\n\t\tlet points_sphere = new THREE.Sphere().setFromPoints(points);\r\n\t\tlet world_space_center = points_sphere.center;\r\n\t\tlet camera_forward = new THREE.Vector3(0,0,1).applyQuaternion(this.reference_rotation)\r\n\t\tlet near_plane = points_sphere.center.clone().add(camera_forward.clone().multiplyScalar(points_sphere.radius));\r\n\t\tlet plane = new THREE.Plane().setFromNormalAndCoplanarPoint(camera_forward, near_plane);\r\n\t\tlet projected_point = new THREE.Vector3();\r\n\t\tlet points_on_plane = [];\r\n\t\tfor(let i=0; i< points.length; i++)\r\n\t\t{\r\n\t\t\tplane.projectPoint(points[i], projected_point);\r\n\t\t\tpoints_on_plane.push(projected_point.clone());\r\n\t\t\t// if(debug)\r\n\t\t\t// {\r\n\t\t\t// \tDebug.draw_cube(projected_point, 25, undefined, 0x0000ff);\r\n\t\t\t// }\r\n\t\t}\r\n\r\n\t\t// if(debug)\r\n\t\t// {\r\n\t\t// \tvar helper = new THREE.PlaneHelper( plane, 5000, 0x00ff00 );\r\n\t\t// \tDebug.webgl.add( helper );\r\n\t\t// }\r\n\r\n\t\tlet up = new THREE.Vector3(0,1,0).applyQuaternion(this.reference_rotation)\r\n\t \tlet right = up.clone().cross(camera_forward).normalize();\r\n\r\n\t\tlet mat = new THREE.Matrix4().set(  right.x, up.x, camera_forward.x, world_space_center.x,\r\n                                        right.y, up.y, camera_forward.y, world_space_center.y,\r\n                                        right.z, up.z, camera_forward.z, world_space_center.z,\r\n                                        \t\t\t0, \t  0,  \t\t\t\t\t\t\t0,\t\t\t\t1);\r\n\r\n\t\tlet inverse_mat = new THREE.Matrix4().getInverse(mat);\r\n\r\n\t\tfor(let i=0; i< points_on_plane.length; i++)\r\n\t\t{\r\n\t\t\tpoints_on_plane[i].applyMatrix4(inverse_mat);\r\n\t\t}\r\n\r\n\t\tlet size = new THREE.Vector3();\r\n\t\tlet box =  new THREE.Box3().setFromPoints(points_on_plane);\r\n\t\tbox.getSize(size);\r\n\t\tsize.multiplyScalar(zoom_scale);\r\n\t\t\r\n\t\tlet projected_center = new THREE.Vector3();\r\n\t\tbox.getCenter(projected_center);\r\n\r\n\t\tif(debug)\r\n\t\t{\r\n\t\t\t// Debug.draw_axis()\r\n\t\t\tlet geo_plane = Debug.draw_plane(size.x, size.y);\r\n\t\t\tgeo_plane.position.add(projected_center);\t\t\r\n\t\t\tgeo_plane.updateMatrixWorld();\r\n\t\t\tgeo_plane.applyMatrix(mat);\t\r\n\t\t\t// Debug.draw_cube(average_center, 50, undefined, 0x0000ff);\r\n\r\n\t\t\tfor(let i=0; i< points_on_plane.length; i++)\r\n\t\t\t{\r\n\t\t\t\tpoints_on_plane[i].applyMatrix4(mat);\r\n\t\t\t\t// if(debug)\r\n\t\t\t\t// \tDebug.draw_cube(points_on_plane[i], 25, undefined, 0xffff00);\r\n\t\t\t}\r\n\t\t\t// Debug.webgl.add( new THREE.PlaneHelper( plane, 5000, 0xffff00 ) );\r\n\t\t}\r\n\r\n\t\tthis.reference_position.copy(projected_center.applyMatrix4(mat).sub(camera_forward.clone().multiplyScalar(points_sphere.radius)));\r\n\r\n\t\tthis.reference_zoom = this.__get_zoom_to_show_rect(size.x/2, size.y/2) + points_sphere.radius;\r\n\t\t       \r\n\t}\r\n\r\n\tget_current_tilt()\r\n\t{\r\n\t\treturn this.current_tilt;\r\n\t}\r\n\tget_current_orientation()\r\n\t{\r\n\t\treturn this.current_orientation;\r\n\t}\r\n\r\n\t__get_zoom_to_show_rect(width,height)\r\n\t{\r\n\t\tlet v_fov = (this.camera.fov/2) * Math.PI/180;\r\n\t\tlet h_fov = (2 * Math.atan(Math.tan(v_fov) * this.camera.aspect))/2;\r\n\r\n\r\n    let distV = height / Math.tan(v_fov);\r\n    let distH = width / Math.tan(h_fov);\r\n    return Math.max(Math.abs(distH), Math.abs(distV));\r\n\r\n\t}\r\n}\r\n","import { BaseApplication } from 'ohzi-core';\r\nimport { CameraManager } from 'ohzi-core';\r\nimport { PerspectiveCamera } from 'ohzi-core';\r\nimport { Screen } from 'ohzi-core';\r\nimport { NormalRender } from 'ohzi-core';\r\nimport { Graphics } from 'ohzi-core';\r\nimport { ResourceContainer } from 'ohzi-core';\r\nimport { Debug } from 'ohzi-core';\r\nimport { Components } from 'ohzi-core';\r\nimport { SceneManager } from 'ohzi-core';\r\n\r\nimport CameraController from '/js/components/CameraController/CameraController';\r\n\r\nexport default class MainApplication extends BaseApplication {\r\n\tconstructor(renderer) {\r\n\t\tsuper();\r\n\t\tthis.renderer = renderer;\r\n\r\n\t\tthis.camera_controller = new CameraController();\r\n\t\tthis.normal_render_mode = new NormalRender();\r\n\r\n\t}\r\n\r\n\tstart() {\r\n\t\tGraphics.set_state(this.normal_render_mode);\r\n\r\n\t\tthis.__init_camera();\r\n\t\tthis.__init_camera_controller();\r\n\t\tthis.on_resize(); // force resize update before the first frame\r\n\r\n\t\tthis.config = ResourceContainer.get_resource(\"config\");\r\n    Debug.draw_axis();\r\n    SceneManager.current.add(new Components.Grid());\r\n\r\n\r\n\t}\r\n\r\n\tupdate() {\r\n    this.camera_controller.update();\r\n\t}\r\n\r\n\ton_resize() {\r\n\t\tGraphics.on_resize();\r\n\t}\r\n\r\n\t__init_camera() {\r\n\t\tlet camera = new PerspectiveCamera(60, Screen.aspect_ratio, 0.1, 200);\r\n\t\tcamera.updateProjectionMatrix();\r\n\t\tcamera.position.z = 10;\r\n\r\n\t\tcamera.clear_color.copy(new THREE.Color(\"#000000\"));\r\n\t\tcamera.clear_alpha = 1;\r\n\t\tCameraManager.current = camera;\r\n\t}\r\n\r\n\t__init_camera_controller() {\r\n\t\tthis.camera_controller.set_camera(CameraManager.current);\r\n\t\t// this.camera_controller.set_idle();\r\n    this.camera_controller.set_debug_mode();\r\n\r\n\t\tthis.camera_controller.min_zoom = 0;\r\n\t\tthis.camera_controller.max_zoom = 40;\r\n\t\tthis.camera_controller.reference_zoom = 30;\r\n\t\tthis.camera_controller.reference_position.set(0, 0, 0);\r\n\t}\r\n\r\n}\r\n","import { Graphics } from 'ohzi-core';\r\nimport { RenderLoop } from 'ohzi-core';\r\nimport { Configuration } from 'ohzi-core';\r\nimport { EventManager } from 'ohzi-core';\r\nimport { Debug } from 'ohzi-core';\r\nimport { Input } from 'ohzi-core';\r\nimport { ResourceContainer } from 'ohzi-core';\r\n\r\n//APP\r\nimport MainApplication from './MainApplication';\r\n\r\nconst application = new MainApplication(Graphics);\r\nconst render_loop = new RenderLoop(application, Graphics);\r\n\r\nwindow.ViewApi = {\r\n  init: (parameters) => {\r\n    let body = document.querySelector('body');\r\n    let canvas = document.getElementById('main-canvas');\r\n\r\n    Configuration.is_mobile = parameters.is_mobile;\r\n    Configuration.is_ios = parameters.is_ios;\r\n    Configuration.is_ipad = parameters.is_ipad;\r\n\r\n    Graphics.init(canvas)\r\n\r\n    Input.init(body, canvas);\r\n    Debug.init(Graphics);\r\n\r\n    Graphics.on_resize();\r\n\r\n  },\r\n\r\n  dispose: () => {\r\n    render_loop.stop();\r\n    Graphics._renderer.dispose();\r\n    map.dispose();\r\n  },\r\n\r\n  draw_debug_axis: () => {\r\n    Debug.draw_axis();\r\n  },\r\n\r\n  register_event: (name, callback) => {\r\n    EventManager.on(name, callback);\r\n  },\r\n\r\n  resize_canvas: () => {\r\n    application.on_resize();\r\n  },\r\n\r\n  resource_loading_completed: () => {\r\n    application.resources_fully_loaded()\r\n  },\r\n\r\n  set_resource: (name, resource) => {\r\n    ResourceContainer.set_resource(name, resource);\r\n  },\r\n\r\n  start: () => {\r\n    render_loop.start();\r\n  },\r\n\r\n  stop: () => {\r\n    render_loop.stop();\r\n  },\r\n\r\n  application: application,\r\n  config: Configuration,\r\n  resource_container: ResourceContainer,\r\n}\r\n"]}